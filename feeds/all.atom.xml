<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Jaime Ashander</title><link href="http://www.ashander.info/" rel="alternate"></link><link href="http://www.ashander.info/feeds/all.atom.xml" rel="self"></link><id>http://www.ashander.info/</id><updated>2015-10-26T00:00:00-07:00</updated><entry><title>So, you did some GLMs &amp; compared with AIC. Congrats!</title><link href="http://www.ashander.info/posts/2015/10/model-selection-glms-aic-what-to-report/" rel="alternate"></link><updated>2015-10-26T00:00:00-07:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2015-10-26:posts/2015/10/model-selection-glms-aic-what-to-report/</id><summary type="html">&lt;p&gt;Here's what you need to report in a paper about the model comparison:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;residual deviance&lt;/li&gt;
&lt;li&gt;residual df&lt;/li&gt;
&lt;li&gt;delta AIC&lt;/li&gt;
&lt;li&gt;AIC weight&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You should also report the null deviance and degrees of freedom, maybe
in a table caption.&lt;/p&gt;
&lt;p&gt;Thanks to &lt;a href="http://brunalab.org/"&gt;Emilio Bruna&lt;/a&gt; for prompting this post
and suggesting its title. Below I'll do a worked example, explain why
you should include at least these numbers, and mention some situations
where it's better to use something other than AIC.&lt;/p&gt;
&lt;h3&gt;Example: UC Berkeley admissions and gender&lt;/h3&gt;
&lt;p&gt;Let's look at the built-in &lt;code&gt;UCBAdmissions&lt;/code&gt; data. As R will tell you,
these data are often used to illustrate Simpson's paradox (see
&lt;code&gt;?UCBAdmissions&lt;/code&gt; and Bickel &lt;em&gt;et al.&lt;/em&gt; 1975 or my PPS below).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;d &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;as.data.frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;UCBAdmissions&lt;span class="p"&gt;)&lt;/span&gt;
d &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; tidyr&lt;span class="o"&gt;::&lt;/span&gt;spread&lt;span class="p"&gt;(&lt;/span&gt;d&lt;span class="p"&gt;,&lt;/span&gt; Admit&lt;span class="p"&gt;,&lt;/span&gt; Freq&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# use Hadley&amp;#39;s excellent tidyr to reshape&lt;/span&gt;
d&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="kp"&gt;order&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;d&lt;span class="o"&gt;$&lt;/span&gt;Dept&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="c1"&gt;##    Gender Dept Admitted Rejected&lt;/span&gt;
&lt;span class="c1"&gt;## 1    Male    A      512      313&lt;/span&gt;
&lt;span class="c1"&gt;## 7  Female    A       89       19&lt;/span&gt;
&lt;span class="c1"&gt;## 2    Male    B      353      207&lt;/span&gt;
&lt;span class="c1"&gt;## 8  Female    B       17        8&lt;/span&gt;
&lt;span class="c1"&gt;## 3    Male    C      120      205&lt;/span&gt;
&lt;span class="c1"&gt;## 9  Female    C      202      391&lt;/span&gt;
&lt;span class="c1"&gt;## 4    Male    D      138      279&lt;/span&gt;
&lt;span class="c1"&gt;## 10 Female    D      131      244&lt;/span&gt;
&lt;span class="c1"&gt;## 5    Male    E       53      138&lt;/span&gt;
&lt;span class="c1"&gt;## 11 Female    E       94      299&lt;/span&gt;
&lt;span class="c1"&gt;## 6    Male    F       22      351&lt;/span&gt;
&lt;span class="c1"&gt;## 12 Female    F       24      317&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Using logistic regression, encode several models for the effect of
applicant gender, department identity, or both on admission.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;m1 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; glm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;cbind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Admitted&lt;span class="p"&gt;,&lt;/span&gt; Rejected&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; Gender&lt;span class="p"&gt;,&lt;/span&gt; d&lt;span class="p"&gt;,&lt;/span&gt; family&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;binomial&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
m2 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; glm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;cbind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Admitted&lt;span class="p"&gt;,&lt;/span&gt; Rejected&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; Dept&lt;span class="p"&gt;,&lt;/span&gt; d&lt;span class="p"&gt;,&lt;/span&gt; family &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;binomial&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
m3 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; glm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;cbind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Admitted&lt;span class="p"&gt;,&lt;/span&gt; Rejected&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; Dept &lt;span class="o"&gt;+&lt;/span&gt; Gender&lt;span class="p"&gt;,&lt;/span&gt; d&lt;span class="p"&gt;,&lt;/span&gt; family &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;binomial&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;(Note: although we might like to allow for an interaction between gender
and department, the data here are insufficient to fit such a model.)&lt;/p&gt;
&lt;p&gt;Running &lt;code&gt;summary&lt;/code&gt; on any one of the fits yields a bunch of stats: AIC,
Residual and null deviance, as well as coefficients, their standard
errors, and significance.&lt;/p&gt;
&lt;h3&gt;What to report&lt;/h3&gt;
&lt;p&gt;We could type by hand the AIC and other stats. Instead, we'll use &lt;a href="http://varianceexplained.org/"&gt;David
Robinson&lt;/a&gt;'s &lt;code&gt;broom&lt;/code&gt; which gives tidy
summaries of model objects.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;summary.table &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;do.call&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;rbind&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kp"&gt;lapply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;m1&lt;span class="p"&gt;,&lt;/span&gt; m2&lt;span class="p"&gt;,&lt;/span&gt; m3&lt;span class="p"&gt;),&lt;/span&gt; broom&lt;span class="o"&gt;::&lt;/span&gt;glance&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="kp"&gt;summary.table&lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;model&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;If we take a look at &lt;code&gt;summary.table&lt;/code&gt;, we'll see it has all the
ingredients we might like to report from model selection, whether via
AIC, BIC, or just the deviance. These are, in order, null.deviance,
df.null, logLik, AIC, BIC, deviance, df.residual, model.&lt;/p&gt;
&lt;p&gt;Creating a table with our own desired columns in an appropriate order is
easy.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;table.cols &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;model&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;df.residual&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;deviance&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;AIC&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
reported.table &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;summary.table&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;table.cols&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="kp"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;reported.table&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Model&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Resid. Df&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Resid. Dev&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;AIC&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;For model selection, a model's AIC is only meaningful relative to that
of other models, so Akaike and others recommend reporting differences in
AIC from the best model, &lt;em&gt;Δ&lt;/em&gt;&lt;em&gt;AIC&lt;/em&gt;, and AIC weights &lt;em&gt;wAIC&lt;/em&gt;. The latter
can be viewed as an estimate of the probability a model gives the best
predictions on new data (conditional on the models considered; Burnham
and Anderson 2002, McElreath 2015).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;reported.table&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;dAIC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt;  &lt;span class="kp"&gt;with&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;reported.table&lt;span class="p"&gt;,&lt;/span&gt; AIC &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="kp"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;AIC&lt;span class="p"&gt;))&lt;/span&gt;
reported.table&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;wAIC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;with&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;reported.table&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kp"&gt;exp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="m"&gt;0.5&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; dAIC&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;exp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="m"&gt;0.5&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; dAIC&lt;span class="p"&gt;)))&lt;/span&gt;
reported.table&lt;span class="o"&gt;$&lt;/span&gt;AIC &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kc"&gt;NULL&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;With this advice in mind, here's &lt;em&gt;a minimal table for reporting model
selection on GLMs&lt;/em&gt;:&lt;/p&gt;
&lt;p&gt;Caption: Model selection for the effect gender (model 1), department
(model 2), and both gender and department (model 3) on admission
probability with 11 null degrees of freedom and 877.06 null deviance.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;reported.table

##   Model Resid. Df Resid. Dev   dAIC     wAIC
## 1     1        10        784 753.87 1.1e-164
## 2     2         6         22   0.00  5.6e-01
## 3     3         5         20   0.47  4.4e-01
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Even if using an information criterion, include the residual deviance
and degrees of freedom for each model. These provide a (rough) goodness
of fit measure for each model.&lt;/p&gt;
&lt;p&gt;Of course, model selection is just the beginning of reporting your
results. See the PPS below for some thoughts on reporting results of the
best model(s).&lt;/p&gt;
&lt;h3&gt;Is AIC the right criterion?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;For small data, you should use AICc -- the small sample correction
    which provides greater penalty for each parameter but approaches AIC
    as &lt;em&gt;n&lt;/em&gt; becomes large. If it makes a difference, you should use it.
    (I probably should have used it above.)&lt;/li&gt;
&lt;li&gt;For large data, consider BIC, which is asymptotically consistent
    while AIC is not (see Hastie &lt;em&gt;et al.&lt;/em&gt; 2009, which is
    available online). AIC typically favors overly-complex models with
    large &lt;em&gt;n&lt;/em&gt; relative to BIC.&lt;/li&gt;
&lt;li&gt;For Bayesian models, consider &lt;a href="http://andrewgelman.com/2015/07/16/new-papers-on-loowaic-and-stan/"&gt;WAIC or
    LOO&lt;/a&gt;
    (instead of DIC, which has issues with non-Gaussian posteriors
    McElreath 2015).&lt;/li&gt;
&lt;li&gt;Don't use information criteria for model selection between GLMs with
    different link functions&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Further Reading &amp;amp; References&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://ms.mcmaster.ca/~bolker/misc/GLMM_results_report.pdf"&gt;Ben Bolker on reporting results in the
    text&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Burnham, Kenneth P., and David R. Anderson. 2002. Model selection
    and multimodel inference: a practical
    information-theoretic approach. Springer, New York, NY, USA.&lt;/li&gt;
&lt;li&gt;&lt;a href="http://statweb.stanford.edu/~tibs/ElemStatLearn/"&gt;Hastie, Tibshirani, and Friedman.
    2009&lt;/a&gt; Elements of
    Statistical Learning, Second Edition. Springer, New York, NY, USA.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.crcpress.com/Statistical-Rethinking-A-Bayesian-Course-with-Examples-in-R-and-Stan/McElreath/9781482253443"&gt;McElreath. 2015.&lt;/a&gt;
    Statistical Rethinking. CRC Press.&lt;/li&gt;
&lt;li&gt;&lt;a href="http://brianomeara.info/tutorials/aic/"&gt;Brian O'Meara's AIC
    tutorial&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;PS: Nested models&lt;/h3&gt;
&lt;p&gt;Reporting the residual deviance and degrees of freedom as above is
relatively similar to R's output for conducting an ANOVA on a GLM (where
you can optionally add a statistical test). For nested models, you may
as well just do this and report the table:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;m3.anova &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; anova&lt;span class="p"&gt;(&lt;/span&gt;m3&lt;span class="p"&gt;,&lt;/span&gt; test&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Chisq&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;m3.anova&lt;span class="p"&gt;,&lt;/span&gt; digits &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;## Analysis of Deviance Table&lt;/span&gt;
&lt;span class="c1"&gt;## &lt;/span&gt;
&lt;span class="c1"&gt;## Model: binomial, link: logit&lt;/span&gt;
&lt;span class="c1"&gt;## &lt;/span&gt;
&lt;span class="c1"&gt;## Response: cbind(Admitted, Rejected)&lt;/span&gt;
&lt;span class="c1"&gt;## &lt;/span&gt;
&lt;span class="c1"&gt;## Terms added sequentially (first to last)&lt;/span&gt;
&lt;span class="c1"&gt;## &lt;/span&gt;
&lt;span class="c1"&gt;## &lt;/span&gt;
&lt;span class="c1"&gt;##        Df Deviance Resid. Df Resid. Dev Pr(&amp;gt;Chi)    &lt;/span&gt;
&lt;span class="c1"&gt;## NULL                      11     877.06             &lt;/span&gt;
&lt;span class="c1"&gt;## Dept    5   855.32         6      21.74   &amp;lt;2e-16 ***&lt;/span&gt;
&lt;span class="c1"&gt;## Gender  1     1.53         5      20.20   0.2159    &lt;/span&gt;
&lt;span class="c1"&gt;## ---&lt;/span&gt;
&lt;span class="c1"&gt;## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;PPS: Evaluating the best model&lt;/h3&gt;
&lt;p&gt;For the best model(s), you should then go on to report model results in
the text, as &lt;a href="http://ms.mcmaster.ca/~bolker/misc/GLMM_results_report.pdf"&gt;Ben Bolker
demonstrates&lt;/a&gt;,
and visualize the fit relative to the data.&lt;/p&gt;
&lt;p&gt;To visualize the admissions data and mean fits from models 2 and 3
(which have approximately equal AIC weight), we can use &lt;code&gt;ggplot2&lt;/code&gt; and
&lt;code&gt;augment&lt;/code&gt; from broom (which adds model predictions and statistics to the
data):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;m3.pred &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; broom&lt;span class="o"&gt;::&lt;/span&gt;augment&lt;span class="p"&gt;(&lt;/span&gt;m3&lt;span class="p"&gt;)&lt;/span&gt;
m2.pred &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; broom&lt;span class="o"&gt;::&lt;/span&gt;augment&lt;span class="p"&gt;(&lt;/span&gt;m2&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kn"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;ggplot2&lt;span class="p"&gt;)&lt;/span&gt;
ggplot&lt;span class="p"&gt;(&lt;/span&gt;d&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
    geom_point&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;Dept&lt;span class="p"&gt;,&lt;/span&gt; Admitted &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;Admitted &lt;span class="o"&gt;+&lt;/span&gt; Rejected&lt;span class="p"&gt;),&lt;/span&gt; color&lt;span class="o"&gt;=&lt;/span&gt;Gender&lt;span class="p"&gt;,&lt;/span&gt; size&lt;span class="o"&gt;=&lt;/span&gt;Admitted &lt;span class="o"&gt;+&lt;/span&gt; Rejected&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
    geom_point&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;Dept&lt;span class="p"&gt;,&lt;/span&gt; plogis&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;.&lt;/span&gt;fitted&lt;span class="p"&gt;)),&lt;/span&gt; data &lt;span class="o"&gt;=&lt;/span&gt;m2.pred&lt;span class="p"&gt;,&lt;/span&gt; shape &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; alpha&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0.4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; geom_point&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;Dept&lt;span class="p"&gt;,&lt;/span&gt; plogis&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;.&lt;/span&gt;fitted&lt;span class="p"&gt;),&lt;/span&gt; shape&lt;span class="o"&gt;=&lt;/span&gt;Gender&lt;span class="p"&gt;),&lt;/span&gt; alpha &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;0.4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; data &lt;span class="o"&gt;=&lt;/span&gt; m3.pred&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
    theme_minimal&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; scale_color_manual&lt;span class="p"&gt;(&lt;/span&gt;values&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;orange&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; guides&lt;span class="p"&gt;(&lt;/span&gt;shape&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;FALSE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="Admissions (open circles, size indicates total applicants) versus
deparatment and predictions from model 2 (department only, diamonds) and
model 3 (department and gender, dots and
triangles)" src="http://www.ashander.info/posts/2015/10/model-selection-glms-aic-what-to-report/model-selection-GLMs-AIC-what-to-report_files/figure-markdown_strict/model-viz-1.svg" /&gt;&lt;/p&gt;
&lt;p&gt;Admissions (colored dots, size indicates total applicants) versus
department and predictions from model 2 (department only, diamonds) and
model 3 (department and gender, dots and triangles)&lt;/p&gt;
&lt;h4&gt;Simpson's paradox&lt;/h4&gt;
&lt;p&gt;Comparing model 3 with model 1 illustrates Simpson's paradox. Without
accounting for department, the apparent effect of female gender on
admission is negative (female odds relative to male 0.54, &lt;em&gt;p&lt;/em&gt; ≈ 0),
whereas after accounting for department, the effect is positive (but
weak: female odds relative to male 1.11, &lt;em&gt;p&lt;/em&gt; ≈  0.22).&lt;/p&gt;</summary><category term="R"></category><category term="statistics"></category><category term="model selection"></category><category term="GLM"></category><category term="AIC"></category><category term="deviance"></category></entry><entry><title>Easy alternatives to bar charts in native R graphics</title><link href="http://www.ashander.info/posts/2015/04/barchart-alternatives-in-base-r/" rel="alternate"></link><updated>2015-04-28T00:00:00-07:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2015-04-28:posts/2015/04/barchart-alternatives-in-base-r/</id><summary type="html">&lt;p&gt;It's a long tradition in statistical graphics going from Tufte back to
&lt;a href="http://en.wikipedia.org/wiki/John_Tukey#Scientific_contributions"&gt;Tukey&lt;/a&gt;
and
&lt;a href="http://en.wikipedia.org/wiki/Dot_plot_%28statistics%29#Cleveland_dot_plots"&gt;Cleveland&lt;/a&gt;
to advise against using bar charts. Many folks, &lt;a href="https://twitter.com/jaimedash/status/591289758191636480"&gt;including
me&lt;/a&gt;, have
pejoratively called the common (in ecology, at least) bar chart + SE a
"dynamite plot". Although Ben Bolker has questioned &lt;a href="http://emdbolker.wikidot.com/blog:dynamite"&gt;the wisdom of this
sentiment&lt;/a&gt; , I think in most
cases they're worth avoiding. (I discuss this more in "When and here are
dynamite plots appropriate" below.)&lt;/p&gt;
&lt;p&gt;Last week, Tracey Weissgerber and colleagues extend this tradition,
making a &lt;a href="http://doi.org/10.1371/journal.pbio.1002128"&gt;great set of concrete recommendations in a perspective for
PLoS Biology&lt;/a&gt;. Importantly,
the authors also provided a &lt;a href="https://www.ctspedia.org/do/view/CTSpedia/TemplateTesting"&gt;set of Excel templates on
CTSpedia&lt;/a&gt; (a
cool-looking site for sharing resources related to clinical trials) that
implement their recommendations in Excel.&lt;/p&gt;
&lt;p&gt;This is great because in Excel making good graphics is &lt;em&gt;really&lt;/em&gt; hard. So
people don't do it. Best practices have little appeal if they also
involve lots of work! Fortunately in &lt;a href="http://www.r-project.org/"&gt;R&lt;/a&gt;, the
recommended alternatives are built in, and even easier to use.&lt;/p&gt;
&lt;p&gt;Here, I'll provide some minimal code to make plots similar to those
Weissgerber &lt;em&gt;et al&lt;/em&gt; recommend, both for independent groups and paired
data, using the built-in graphics of &lt;a href="http://www.r-project.org/"&gt;R&lt;/a&gt;.&lt;/p&gt;
&lt;h1&gt;Independent groups&lt;/h1&gt;
&lt;p&gt;For convenience, I'm using the built in &lt;code&gt;CO2&lt;/code&gt; dataset:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;head(CO2)

##   Plant   Type  Treatment conc uptake
## 1   Qn1 Quebec nonchilled   95   16.0
## 2   Qn1 Quebec nonchilled  175   30.4
## 3   Qn1 Quebec nonchilled  250   34.8
## 4   Qn1 Quebec nonchilled  350   37.2
## 5   Qn1 Quebec nonchilled  500   35.3
## 6   Qn1 Quebec nonchilled  675   39.2
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;These data come from an experiment on cold tolerance in grasses from
different regions, but the specifics here don't matter. The data were
first published in &lt;em&gt;Ecology&lt;/em&gt; in 1990. See &lt;code&gt;?CO2&lt;/code&gt; in R if you'd like to
know more.&lt;/p&gt;
&lt;p&gt;Mostly, I'll plot CO2 concentration versus uptake or Type, the plant's
source region.&lt;/p&gt;
&lt;p&gt;First, a bad ol' dynamite, er bar plot:&lt;/p&gt;
&lt;p&gt;&lt;img alt="bad bar
plot" src="http://www.ashander.info/posts/2015/04/barchart-alternatives-in-base-r/barchart-alternatives-in-base-R_files/figure-markdown_strict/barplot-1.svg" /&gt;&lt;/p&gt;
&lt;p&gt;(I'm not including the code for this, because it's what I'm recommending
against. Nor did I add error bars, so it's not really a dynamite plot.
R's base graphics make both producing this plot and, especially, adding
error bars to it, tedious compared to box plots or strip charts. Maybe
this is a feature. External libraries like &lt;code&gt;ggplot&lt;/code&gt; or &lt;code&gt;gplots&lt;/code&gt; make
such graphics a lot easier. See link at the end of this post.)&lt;/p&gt;
&lt;h2&gt;Scatter plots&lt;/h2&gt;
&lt;p&gt;The first type of plot is a univariate scatter plot. Most often, you'd
want to plot a response against some observational or experimental
factors. Another name for this type of plot is &lt;code&gt;stripchart&lt;/code&gt;, which is
what R calls it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;CO2 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;within&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;CO2&lt;span class="p"&gt;,&lt;/span&gt; conc_f &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;factor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;conc&lt;span class="p"&gt;))&lt;/span&gt;
y_limits &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kp"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;CO2&lt;span class="o"&gt;$&lt;/span&gt;uptake&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="m"&gt;1.15&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
point_col &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; gray&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0.4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
stripchart&lt;span class="p"&gt;(&lt;/span&gt;uptake &lt;span class="o"&gt;~&lt;/span&gt; conc_f&lt;span class="p"&gt;,&lt;/span&gt; CO2&lt;span class="p"&gt;,&lt;/span&gt; method&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;jitter&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; pch&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; col&lt;span class="o"&gt;=&lt;/span&gt;point_col&lt;span class="p"&gt;,&lt;/span&gt;
           xlab&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;concentration&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; ylim&lt;span class="o"&gt;=&lt;/span&gt;y_limits&lt;span class="p"&gt;,&lt;/span&gt; vertical&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="stripchart: a scatter plot v
factors" src="http://www.ashander.info/posts/2015/04/barchart-alternatives-in-base-r/barchart-alternatives-in-base-R_files/figure-markdown_strict/scatter-v-factors-1.svg" /&gt;&lt;/p&gt;
&lt;p&gt;It's easy to jitter the points, as Weissgerber &lt;em&gt;et al&lt;/em&gt; recommend, by
passing the argument &lt;code&gt;method='jitter'&lt;/code&gt;. But there are other options. For
cases where there really isn't much data, &lt;code&gt;method='stack'&lt;/code&gt; gives
something closer to a &lt;a href="http://en.wikipedia.org/wiki/Dot_plot_%28statistics%29#Wilkinson_dot_plots"&gt;Wilkinson dot
plot&lt;/a&gt;.
This more clearly shows the values that were observed more than once:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;stripchart(uptake ~ conc_f, CO2, method=&amp;#39;stack&amp;#39;, pch=19, col=point_col,
           xlab=&amp;#39;concentration&amp;#39;,  ylim=y_limits, vertical=TRUE)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="stripchart with
stacking" src="http://www.ashander.info/posts/2015/04/barchart-alternatives-in-base-r/barchart-alternatives-in-base-R_files/figure-markdown_strict/stripchart-wilkinson-1.svg" /&gt;&lt;/p&gt;
&lt;h2&gt;Box (and whisker) plots&lt;/h2&gt;
&lt;p&gt;For box plots, R makes it very easy.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;boxplot( uptake ~ conc_f , CO2, ylab=&amp;#39;uptake&amp;#39;, xlab=&amp;#39;concentration&amp;#39;, ylim=y_limits)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="boxplot" src="http://www.ashander.info/posts/2015/04/barchart-alternatives-in-base-r/barchart-alternatives-in-base-R_files/figure-markdown_strict/boxplot-1.svg" /&gt;&lt;/p&gt;
&lt;p&gt;In this case, with small data the boxplot is a bit misleading. This is
clear from the scatter plots above, but you can also overplot onto the
boxes using &lt;code&gt;stripchart&lt;/code&gt; with &lt;code&gt;add = TRUE, vertical = TRUE&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;{
  boxplot( uptake ~ conc_f , CO2, ylab=&amp;#39;uptake&amp;#39;, xlab=&amp;#39;concentration&amp;#39;, ylim=y_limits)
  stripchart(uptake ~ conc_f, CO2, method = &amp;#39;jitter&amp;#39;, add = TRUE, vertical = TRUE,
             pch = 19)
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="boxplot with points
overplotted" src="http://www.ashander.info/posts/2015/04/barchart-alternatives-in-base-r/barchart-alternatives-in-base-R_files/figure-markdown_strict/boxplot-overplotted-1.svg" /&gt;&lt;/p&gt;
&lt;p&gt;Even with base graphics &lt;code&gt;boxplot&lt;/code&gt;, you can pass functions of multiple
independent variables. This means you can visualize interactions between
treatments in your raw data, and even overplot with &lt;code&gt;stripchart&lt;/code&gt;!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;{
  boxplot( uptake ~ conc_f : Treatment, CO2, ylab=&amp;#39;uptake&amp;#39;, ylim=y_limits,
          xlab = &amp;quot;concentration within chilling treatment&amp;quot;)
  stripchart(uptake ~ conc_f : Treatment, CO2, method = &amp;#39;jitter&amp;#39;, add = TRUE, vertical = TRUE,
             pch = 19)
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="complex bar
plot" src="http://www.ashander.info/posts/2015/04/barchart-alternatives-in-base-r/barchart-alternatives-in-base-R_files/figure-markdown_strict/complex-boxplot-1.svg" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Note&lt;/em&gt; it would be easier to read the labels here if the plot were
horizontal, for which there's an argument you can pass. The graphics
settings on this post aren't playing well with long labels, so I don't
evaluate this here:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;op &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; par&lt;span class="p"&gt;(&lt;/span&gt;las &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; mar &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="c1"&gt;# all axis labels horizontal&lt;/span&gt;
   boxplot&lt;span class="p"&gt;(&lt;/span&gt; uptake &lt;span class="o"&gt;~&lt;/span&gt; conc_f &lt;span class="o"&gt;%in%&lt;/span&gt; Treatment&lt;span class="p"&gt;,&lt;/span&gt; CO2&lt;span class="p"&gt;,&lt;/span&gt; xlab&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;uptake&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; horizontal&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
par&lt;span class="p"&gt;(&lt;/span&gt;op&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Paired data&lt;/h2&gt;
&lt;p&gt;The CO2 data aren't paired. To look at paired scatter plots, I'll use
the built in &lt;code&gt;sleep&lt;/code&gt; data, which show extra sleep for subjects taking
two sleep aids.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;head(sleep)

##   extra group ID
## 1   0.7     1  1
## 2  -1.6     1  2
## 3  -0.2     1  3
## 4  -1.2     1  4
## 5  -0.1     1  5
## 6   3.4     1  6
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The easiest way to make plots that link paired data is to again use
&lt;code&gt;stripchart&lt;/code&gt; as a base. Then, to add lines illustrating the pairs, one
can use &lt;code&gt;split&lt;/code&gt; and &lt;code&gt;lines&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;  stripchart(extra ~ group, sleep, pch=19, col=point_col,&lt;/span&gt;
&lt;span class="x"&gt;             vertical=TRUE, ylab=&amp;#39;extra sleep&amp;#39;, xlab=&amp;#39;drug received&amp;#39;)&lt;/span&gt;
&lt;span class="x"&gt;  for(ID in split(sleep, sleep&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;ID&lt;/span&gt;&lt;span class="x"&gt;))&lt;/span&gt;
&lt;span class="x"&gt;    lines(extra ~ group, ID)&lt;/span&gt;
&lt;span class="x"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="paired points connected by lines and marked by
points" src="http://www.ashander.info/posts/2015/04/barchart-alternatives-in-base-r/barchart-alternatives-in-base-R_files/figure-markdown_strict/paired-points-1.svg" /&gt;&lt;/p&gt;
&lt;p&gt;If you'd rather only have the lines, just suppress plotting of points
within the initial call to &lt;code&gt;stripchart&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;  stripchart(extra ~ group, sleep, pch=&amp;quot;&amp;quot;, vertical=TRUE,&lt;/span&gt;
&lt;span class="x"&gt;             ylab=&amp;#39;extra sleep&amp;#39;, xlab=&amp;#39;drug received&amp;#39;)&lt;/span&gt;
&lt;span class="x"&gt;  for(ID in split(sleep, sleep&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;ID&lt;/span&gt;&lt;span class="x"&gt;))&lt;/span&gt;
&lt;span class="x"&gt;    lines(extra ~ group, ID)&lt;/span&gt;
&lt;span class="x"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="paired locations connected by
lines" src="http://www.ashander.info/posts/2015/04/barchart-alternatives-in-base-r/barchart-alternatives-in-base-R_files/figure-markdown_strict/paired-lines-1.svg" /&gt;&lt;/p&gt;
&lt;h1&gt;Other plots&lt;/h1&gt;
&lt;p&gt;R easily produces many other plots, in addition to those Weissgerber &lt;em&gt;et
al&lt;/em&gt; for which provide templates.&lt;/p&gt;
&lt;p&gt;For example, say you'd like a histograms across subsets. Here's one for
uptake from the &lt;code&gt;CO2&lt;/code&gt; data for grass plants receiving chilling or not:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;op &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; par&lt;span class="p"&gt;(&lt;/span&gt;mfrow&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="kr"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;v &lt;span class="kr"&gt;in&lt;/span&gt; &lt;span class="kp"&gt;levels&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;CO2&lt;span class="o"&gt;$&lt;/span&gt;Treatment&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  subs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;subset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;CO2&lt;span class="p"&gt;,&lt;/span&gt; Treatment &lt;span class="o"&gt;==&lt;/span&gt; v&lt;span class="p"&gt;)&lt;/span&gt;
  hist&lt;span class="p"&gt;(&lt;/span&gt;subs&lt;span class="o"&gt;$&lt;/span&gt;uptake&lt;span class="p"&gt;,&lt;/span&gt; main &lt;span class="o"&gt;=&lt;/span&gt; v&lt;span class="p"&gt;,&lt;/span&gt; col &lt;span class="o"&gt;=&lt;/span&gt; point_col&lt;span class="p"&gt;,&lt;/span&gt; xlab &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;uptake&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; xlim &lt;span class="o"&gt;=&lt;/span&gt; y_limits&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="histogram of
uptake" src="http://www.ashander.info/posts/2015/04/barchart-alternatives-in-base-r/barchart-alternatives-in-base-R_files/figure-markdown_strict/histo-1.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;par(op)
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;References: plotting libraries and examples&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://www.statmethods.net/advgraphs/trellis.html"&gt;lattice&lt;/a&gt; uses a
    formula interface on top of grid graphics&lt;/li&gt;
&lt;li&gt;&lt;a href="http://ggplot2.org/"&gt;ggplot2&lt;/a&gt; implements the grammar of graphics on
    top of grid graphics&lt;/li&gt;
&lt;li&gt;&lt;em&gt;note&lt;/em&gt; if you're familiar with one of the above and not the other,
    &lt;a href="http://docs.ggplot2.org/0.9.3.1/translate_qplot_lattice.html"&gt;see this guide to translating between lattice and
    qplot&lt;/a&gt;
    and &lt;a href="https://learnr.wordpress.com/2009/08/26/ggplot2-version-of-figures-in-lattice-multivariate-data-visualization-with-r-final-part/"&gt;this post summarizing an extensive comparison of the two
    libraries&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Ben Bolker's &lt;a href="http://emdbolker.wikidot.com/blog:dynamite"&gt;post on dynamite
    plots&lt;/a&gt;, in which he
    produces a variety of plots on the same data using both &lt;code&gt;ggplot2&lt;/code&gt;
    and an older library &lt;code&gt;gplots&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;When and where are dynamite plots appropriate?&lt;/h1&gt;
&lt;p&gt;In addition to Ben's post linked above, Solomon Messing has some nice
reasons to choose dot plots for estimates +/- SE (&lt;a href="https://solomonmessing.wordpress.com/2012/03/04/visualization-series-insight-from-cleveland-and-tufte-on-plotting-numeric-data-by-groups/"&gt;three paragraphs
beginning with "Why do I use dot
plots..."&lt;/a&gt;).
These boil down to:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;bar charts emphasize comparison to zero, which can make comparison
    of small differences difficult&lt;/li&gt;
&lt;li&gt;bars are often used in histograms, which can confuse some audiences&lt;/li&gt;
&lt;li&gt;dot plots use more ink, and cognition, which causes the eye to
    compare the estimate with the baseline&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I agree with Ben that this last feature, the implied reference to a
baseline, means bar charts, can be very useful. But there's a corollary
here: only use this strength when comparison to a baseline is the point.
Further, then, if your graphics are to be honest, they must start at a
meaningful zero. So, avoid bar charts for estimated quantities. Unless,
your main comparison is between estimates with different, or with
magnitudes very close to zero.&lt;/p&gt;</summary><category term="R"></category><category term="statistical graphics"></category><category term="visualization"></category><category term="ggplot2"></category><category term="lattice"></category></entry><entry><title>Overcoming the fear of failure to improve the conservation of extremely small populations</title><link href="http://www.ashander.info/posts/2015/04/fear-of-failure-in-conservation/" rel="alternate"></link><updated>2015-04-22T00:00:00-07:00</updated><author><name>Meek</name></author><id>tag:www.ashander.info,2015-04-22:posts/2015/04/fear-of-failure-in-conservation/</id><summary type="html">&lt;p&gt;The potential for extirpation of extremely small populations (ESPs) is
high due to their vulnerability to demographic and environmental
stochasticity and negative impacts of human activity. We argue that
conservation actions that could aid ESPs are sometimes delayed because
of a fear of failure. In human psychology, the fear of failure is
composed of several distinct cognitive elements, including
"uncertainty about the future" and "upsetting important others."
Uncertainty about the future is often driven by infor- mation
obstacles in conservation: information is either not easily shared
among practitioners or informa- tion is lacking. Whereas, fear of
upsetting important others can be due to apprehension about angering
constituents, peers, funders, and other stakeholders. We present
several ways to address these fears in hopes of improving the
conservation process. We describe methods for increased information
sharing and improved decision-making in the face of uncertainty, and
recommend a shift in focus to cooperative actions and improving
methods for evaluating success. Our hope is that by tackling stumbling
blocks due to the apprehension of failure, conservation and management
organizations can take steps to move from fear to action.&lt;/p&gt;</summary><category term="peer reviewed"></category><category term="Ph.D."></category><category term="conservation"></category><category term="small populations"></category><category term="extinction"></category><category term="stochastic"></category></entry><entry><title>Visualizing fits, inference, implications of (G)LMMs</title><link href="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/" rel="alternate"></link><updated>2015-04-26T00:00:00-07:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2015-04-10:posts/2015/04/D-RUG-mixed-effects-viz/</id><summary type="html">&lt;p&gt;In a live walk-through on April 10 at the Davis R-Users Group, I gave a
brief presentation &lt;a href="http://www.ashander.info/presentations/mixedeffects_viz_motivation.html"&gt;motivating this
topic&lt;/a&gt;.
This post expands and cleans up the code from that talk. If you just
want the code: &lt;a href="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz.R"&gt;download the .R file&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Updated 2015-04-28&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The point of this post isn't the statistics of mixed models. For that,
learning the experimental design and statistics behind modern mixed
models, I recommend some relatively recent papers below. In short,
Schielzeth &amp;amp; Nakagawa (2013) and Stroup (2015) provide especially good
introduction for those coming from an ANOVA background.&lt;/p&gt;
&lt;p&gt;When working with generalized, hierarchical designs, ask yourself three
questions:&lt;/p&gt;
&lt;p&gt;First (and maybe most important), "Do I &lt;em&gt;really&lt;/em&gt; need these models?"
Think carefully, and consult these references:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Is nesting doing anything for your analysis? Example 1: Murtaugh
    2007 &lt;em&gt;Ecology&lt;/em&gt; 88(1):56-62)&lt;/li&gt;
&lt;li&gt;For significance testing, transform + LMM might work as well as
    GLMM: &lt;a href="doi:10.1111/2041-210X.12386"&gt;Ives 2015 "For testing the significance of regression
    coefficients, go ahead and log-transform count data" &lt;em&gt;Methods in
    Ecology and Evolution&lt;/em&gt;&lt;/a&gt; [1]&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Second, "What &lt;em&gt;is&lt;/em&gt; my design (in the language of mixed models)?". Baayen
et al focus on designs with crossed random effects (a strong suit of
&lt;code&gt;lme4&lt;/code&gt;), while Schielzeth &amp;amp; Nakagawa's "Nested by Design" paper is a
more general introduction. Finally, the Stroup paper provides a good
entry point in ANOVA-speak [2]. This could make or break the connection
between an adviser that speaks only ANOVA, as is often the case for
workers in crop and soil sciences, or experimental ecology and the GLMM
that your unbalanced binomial regression demands.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://onlinelibrary.wiley.com/doi/10.1111/j.2041-210x.2012.00251.x/full"&gt;Schielzeth &amp;amp; Nakagawa 2013 Nested by design: model fitting and
    interpretation in a mixed model era. &lt;em&gt;Methods in Ecology and
    Evolution&lt;/em&gt;
    4:14-24&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.sfs.uni-tuebingen.de/~hbaayen/publications/baayenDavidsonBates.pdf"&gt;Baayen, Davidson, &amp;amp; Bates 2008 Mixed-effects modeling with crossed
    random effects for subjects and items. &lt;em&gt;Journal of Memory and
    Language&lt;/em&gt;
    59:390-412&lt;/a&gt;
    Note that Baayen et al present &lt;code&gt;lme4&lt;/code&gt; code, but some (e.g.,
    &lt;code&gt;mcmcsamp&lt;/code&gt;will not work with current versions of the package).&lt;/li&gt;
&lt;li&gt;&lt;a href="https://dl.sciencesocieties.org/publications/aj/abstracts/107/2/811"&gt;Stroup 2015 Rethinking the Analysis of Non-Normal Data in Plant and
    Soil Science. &lt;em&gt;Agronomy Journal&lt;/em&gt;
    107(2):811-827&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Third, "How do I specify and fit this model in &lt;code&gt;R&lt;/code&gt;. The references below
may also help with design and interpretation, but are primarily
hands-on. The most thorough is Pinheiro &amp;amp; Bates (2000). These four
references also serve as a bibliography of sorts for this post [3].&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Pinheiro &amp;amp; Bates 2000 &lt;em&gt;Mixed-effects models in S and S-PLUS&lt;/em&gt;
    Springer, New York&lt;/li&gt;
&lt;li&gt;&lt;a href="http://lme4.r-forge.r-project.org/book/"&gt;Bates' &lt;code&gt;lme4&lt;/code&gt; book draft&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://arxiv.org/abs/1406.5823"&gt;the lme4 paper&lt;/a&gt;:&lt;/li&gt;
&lt;li&gt;Ben Bolker's forthcoming chapter on "Worked examples" &lt;a href="https://rpubs.com/bbolker/glmmchapter"&gt;available on
    Rpubs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Focus of this post&lt;/h3&gt;
&lt;p&gt;Given these preliminaries, here I &lt;strong&gt;focus on three things&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;criticizing the model and fit&lt;/li&gt;
&lt;li&gt;(graphically) assessing parameter inference&lt;/li&gt;
&lt;li&gt;illustrate predictions&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;emphasizing&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;working with frequentist library &lt;code&gt;lme4&lt;/code&gt; for (G)LMM in R&lt;/li&gt;
&lt;li&gt;visualization for: criticism, inference, prediction&lt;/li&gt;
&lt;li&gt;using the native plotting capabilities (to the extent possible)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;three facets&lt;/strong&gt; of visualization&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;quick diagnostic (plots &lt;em&gt;native&lt;/em&gt; to fitting packages)&lt;/li&gt;
&lt;li&gt;slower model criticism (also &lt;em&gt;native&lt;/em&gt;)&lt;/li&gt;
&lt;li&gt;inference &amp;amp; prediction (generally lightweight external libraries /
    export capabilities)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Finally, I'll mention that example code and vignettes in documented
packages are great resources for learning these things (as is google ;).
Try these commands:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;??lme4
help(package=&amp;#39;lme4&amp;#39;)
methods(class=&amp;#39;merMod&amp;#39;)
vignette(package=&amp;#39;lme4&amp;#39;)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Packages:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;library(lme4)
library(lattice) ## already loaded via namespace by lme4 -- may as well attach
#library(ggplot2) # recommend
#library(lsmeans) #recommend
#library(gridExtra) #recommend
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Below, much of the commentary is included in &lt;code&gt;# comments&lt;/code&gt; to the code
blocks.&lt;/p&gt;
&lt;h1&gt;LMM: greenhouse full factorial (RCBD)&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;"Simple" greenhouse, linear mixed model&lt;/li&gt;
&lt;li&gt;Pattern and amount -- cool question!&lt;/li&gt;
&lt;li&gt;balanced so perfect for traditional ANOVA&lt;/li&gt;
&lt;li&gt;4 (!) treatments -- full factorial blocked so 4-way interaction
    potential and hard to visualize (making a good test case here)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="Maestre title image" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/figures/maestre.png" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nx"&gt;d&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;read&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;delim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://datadryad.org/bitstream/handle/10255/dryad.41984/Maestre_Ecol88.txt?sequence=1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nx"&gt;recode&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;car&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="nx"&gt;recode&lt;/span&gt;
&lt;span class="nx"&gt;d&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;within&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;nutrient_hetero&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;recode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;factor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;nh&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;1=&amp;#39;homogeneous&amp;#39;; 2=&amp;#39;heterogeneous&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nx"&gt;nutrient_add&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;recode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;factor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;na&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;1=&amp;#39;40 mg N&amp;#39;; 2=&amp;#39;80 mg N&amp;#39;; 3=&amp;#39;120 mg N&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nx"&gt;water_hetero&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;recode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;factor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;wh&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;1=&amp;#39;homogeneous&amp;#39;; 2=&amp;#39;pulse&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nx"&gt;water_add&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;recode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;factor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;wa&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;1=&amp;#39;125 mL&amp;#39;; 2=&amp;#39;250 mL&amp;#39;;3=&amp;#39;375 mL&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nx"&gt;block&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;factor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;block&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="nx"&gt;d$nutrient_add&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;factor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d$nutrient_add&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;levels&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d$nutrient_add&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="nx"&gt;centered&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;
&lt;span class="nx"&gt;ctr&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...)&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;v&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nx"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...)&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="nx"&gt;sd&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...)&lt;/span&gt;

&lt;span class="nx"&gt;d&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;within&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;nhc&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;ctr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;nh&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nx"&gt;nac&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;ctr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;na&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nx"&gt;wac&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;ctr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;wa&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nx"&gt;whc&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;ctr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;wh&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;

&lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="nx"&gt;bt&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nx"&gt;total&lt;/span&gt; &lt;span class="nx"&gt;biomass&lt;/span&gt;

&lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="nx"&gt;we&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;d like to use model that includes varying sopes&lt;/span&gt;
&lt;span class="s1"&gt;## watering seems the most likely to have block-level differences ?&lt;/span&gt;
&lt;span class="s1"&gt;m2 &amp;lt;- lmer(log(bt) ~ nutrient_add * nutrient_hetero  *  water_add * water_hetero +&lt;/span&gt;
&lt;span class="s1"&gt;               (water_hetero * water_add | block), data=d)&lt;/span&gt;

&lt;span class="s1"&gt;## first diagnostic -- very high correlation is bad -- can&amp;#39;&lt;/span&gt;&lt;span class="nx"&gt;t&lt;/span&gt; &lt;span class="nx"&gt;really&lt;/span&gt; &lt;span class="nx"&gt;justify&lt;/span&gt; &lt;span class="nx"&gt;complex&lt;/span&gt; &lt;span class="nx"&gt;RE&lt;/span&gt;
&lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="nx"&gt;structures&lt;/span&gt; &lt;span class="nx"&gt;you&lt;/span&gt; &lt;span class="nx"&gt;might&lt;/span&gt; &lt;span class="nx"&gt;like&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;cause&lt;/span&gt; &lt;span class="nx"&gt;these&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt; &lt;span class="nx"&gt;of&lt;/span&gt; &lt;span class="nx"&gt;fits&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;
&lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="nx"&gt;could&lt;/span&gt; &lt;span class="nx"&gt;see&lt;/span&gt; &lt;span class="nx"&gt;bad&lt;/span&gt; &lt;span class="nx"&gt;performance&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nx"&gt;resid&lt;/span&gt; &lt;span class="nx"&gt;plots&lt;/span&gt; &lt;span class="nx"&gt;too&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;you&lt;/span&gt; &lt;span class="nx"&gt;wanted&lt;/span&gt;
&lt;span class="nx"&gt;VarCorr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;m2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="err"&gt;##&lt;/span&gt;  &lt;span class="nx"&gt;Groups&lt;/span&gt;   &lt;span class="nx"&gt;Name&lt;/span&gt;                              &lt;span class="nx"&gt;Std&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Dev&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="nx"&gt;Corr&lt;/span&gt;                
&lt;span class="err"&gt;##&lt;/span&gt;  &lt;span class="nx"&gt;block&lt;/span&gt;    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;Intercept&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;                       &lt;span class="mf"&gt;0.031807&lt;/span&gt;                     
&lt;span class="err"&gt;##&lt;/span&gt;           &lt;span class="nx"&gt;water_heteropulse&lt;/span&gt;                 &lt;span class="mf"&gt;0.041753&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.739&lt;/span&gt;              
&lt;span class="err"&gt;##&lt;/span&gt;           &lt;span class="nx"&gt;water_add250&lt;/span&gt; &lt;span class="nx"&gt;mL&lt;/span&gt;                   &lt;span class="mf"&gt;0.061256&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.938&lt;/span&gt;  &lt;span class="mf"&gt;0.643&lt;/span&gt;       
&lt;span class="err"&gt;##&lt;/span&gt;           &lt;span class="nx"&gt;water_add375&lt;/span&gt; &lt;span class="nx"&gt;mL&lt;/span&gt;                   &lt;span class="mf"&gt;0.060199&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.622&lt;/span&gt;  &lt;span class="mf"&gt;0.235&lt;/span&gt;  &lt;span class="mf"&gt;0.848&lt;/span&gt;
&lt;span class="err"&gt;##&lt;/span&gt;           &lt;span class="nx"&gt;water_heteropulse&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nx"&gt;water_add250&lt;/span&gt; &lt;span class="nx"&gt;mL&lt;/span&gt; &lt;span class="mf"&gt;0.074706&lt;/span&gt;  &lt;span class="mf"&gt;0.935&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.930&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.853&lt;/span&gt;
&lt;span class="err"&gt;##&lt;/span&gt;           &lt;span class="nx"&gt;water_heteropulse&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nx"&gt;water_add375&lt;/span&gt; &lt;span class="nx"&gt;mL&lt;/span&gt; &lt;span class="mf"&gt;0.073710&lt;/span&gt;  &lt;span class="mf"&gt;0.427&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.119&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.713&lt;/span&gt;
&lt;span class="err"&gt;##&lt;/span&gt;  &lt;span class="nx"&gt;Residual&lt;/span&gt;                                   &lt;span class="mf"&gt;0.070193&lt;/span&gt;                     
&lt;span class="err"&gt;##&lt;/span&gt;               
&lt;span class="err"&gt;##&lt;/span&gt;               
&lt;span class="err"&gt;##&lt;/span&gt;               
&lt;span class="err"&gt;##&lt;/span&gt;               
&lt;span class="err"&gt;##&lt;/span&gt;               
&lt;span class="err"&gt;##&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.468&lt;/span&gt;       
&lt;span class="err"&gt;##&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.969&lt;/span&gt;  &lt;span class="mf"&gt;0.301&lt;/span&gt;
&lt;span class="err"&gt;##&lt;/span&gt;

&lt;span class="nx"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;m2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;p&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;smooth&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.05&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nx"&gt;id&lt;/span&gt; &lt;span class="nx"&gt;outliers&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/lme-models-1.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;plot(m2, sqrt(abs(resid(.))) ~ fitted(.), type=c(&amp;#39;p&amp;#39;, &amp;#39;smooth&amp;#39;))
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/lme-models-2.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;## slight increase in resid w/ fitted

plot(m2, resid(.) ~ fitted(.) | block, abline=c(h = 0),  lty = 1,  type = c(&amp;quot;p&amp;quot;, &amp;quot;smooth&amp;quot;)) # per block
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/lme-models-3.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;plot(m2,  sqrt(abs(resid(.))) ~ fitted(.) | block,     type=c(&amp;quot;p&amp;quot;, &amp;quot;smooth&amp;quot;)) # 2 blocks behave  badly
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/lme-models-4.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;## block 4 is not great well behaved :(
lattice::qqmath(m2)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/lme-models-5.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="cp"&gt;##&lt;/span&gt;&lt;span class="c"&gt; look at random effect&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;lattice::dotplot(ranef(m2, condVar=TRUE))&lt;/span&gt;

&lt;span class="cp"&gt;##&lt;/span&gt;&lt;span class="c"&gt; $block&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/lme-models-6.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;##were we to have LOTS of RE, using lattice::qqmath for y axis spacing&lt;/span&gt;
&lt;span class="c1"&gt;##based on quantiles of standard normal -- is better to distinguish&lt;/span&gt;
&lt;span class="c1"&gt;##important few from &amp;quot;trivial many&amp;quot;&lt;/span&gt;


&lt;span class="c1"&gt;## want to look @ 4-way but profile diagnostics not working&lt;/span&gt;

&lt;span class="c1"&gt;## for illustrating these, I fit a model with fewer interactions&lt;/span&gt;
&lt;span class="c1"&gt;## use quick plot assess which fixef we can drop (in addition to the RE, unf)&lt;/span&gt;
&lt;span class="c1"&gt;## run drop1(m2) and drop 4-way and water_hetero:nutrient_add&lt;/span&gt;
m1 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; lmer&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;bt&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; nutrient_add &lt;span class="o"&gt;*&lt;/span&gt; water_add &lt;span class="o"&gt;*&lt;/span&gt; nutrient_hetero &lt;span class="o"&gt;+&lt;/span&gt;
           nutrient_hetero &lt;span class="o"&gt;*&lt;/span&gt;  water_add  &lt;span class="o"&gt;*&lt;/span&gt; water_hetero  &lt;span class="o"&gt;+&lt;/span&gt;
           &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; block&lt;span class="p"&gt;),&lt;/span&gt;
           data&lt;span class="o"&gt;=&lt;/span&gt;d&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;## Note: if you look at diagnostics for these, issues pointed out&lt;/span&gt;
&lt;span class="c1"&gt;## above seem even worse. there is a greater increase in resid w/ fitted&lt;/span&gt;
&lt;span class="c1"&gt;## several of the blocks are poorly behaved&lt;/span&gt;
&lt;span class="c1"&gt;## plot(m1, type=c(&amp;quot;p&amp;quot;, &amp;quot;smooth&amp;quot;) , id=0.05) # id outliers&lt;/span&gt;
&lt;span class="c1"&gt;## plot(m1, sqrt(abs(resid(.))) ~ fitted(.), type=c(&amp;#39;p&amp;#39;, &amp;#39;smooth&amp;#39;))&lt;/span&gt;
&lt;span class="c1"&gt;## plot(m1, resid(.) ~ fitted(.) | block, abline=c(h=0), lty=1,  type=c(&amp;quot;p&amp;quot;, &amp;quot;smooth&amp;quot;)) # per block&lt;/span&gt;
&lt;span class="c1"&gt;## plot(m1,  sqrt(abs(resid(.))) ~ fitted(.) | block,     type=c(&amp;quot;p&amp;quot;, &amp;quot;smooth&amp;quot;)) # 2 blocks behave  badly&lt;/span&gt;
&lt;span class="c1"&gt;## lattice::qqmath(m1)&lt;/span&gt;
&lt;span class="c1"&gt;## lattice::dotplot(ranef(m1, condVar=TRUE))&lt;/span&gt;

&lt;span class="c1"&gt;## to get more informative diagnostics -- need to profile&lt;/span&gt;
&lt;span class="kp"&gt;system.time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;m1.prall &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; profile&lt;span class="p"&gt;(&lt;/span&gt;m1&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="c1"&gt;##    user  system elapsed &lt;/span&gt;
&lt;span class="c1"&gt;##   3.294   0.039   3.401&lt;/span&gt;

&lt;span class="kp"&gt;system.time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;m1.prre &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; profile&lt;span class="p"&gt;(&lt;/span&gt;m1&lt;span class="p"&gt;,&lt;/span&gt; which&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;theta_&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; maxmult&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="c1"&gt;## lower maxmult to avoid step error&lt;/span&gt;

&lt;span class="c1"&gt;##    user  system elapsed &lt;/span&gt;
&lt;span class="c1"&gt;##   0.575   0.001   0.576&lt;/span&gt;

lattice&lt;span class="o"&gt;::&lt;/span&gt;xyplot&lt;span class="p"&gt;(&lt;/span&gt;m1.prall&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/linear-profile-based-diagnostics-1.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;# lattice::xyplot(m1.prre) # for only re
# the &amp;#39;profile zeta plot&amp;#39; linear indicates a quadratic
# likelihood profile, and so Wald approximations for CI will work well
# random effects parameters on a standard deviation (or correlation)
# scale

lattice::densityplot(m1.prall)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/linear-profile-based-diagnostics-2.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nx"&gt;the&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;profile density plot&amp;#39;&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nx"&gt;approximate&lt;/span&gt; &lt;span class="nx"&gt;probability&lt;/span&gt; &lt;span class="nx"&gt;density&lt;/span&gt; &lt;span class="nx"&gt;functions&lt;/span&gt; &lt;span class="nx"&gt;of&lt;/span&gt; &lt;span class="nx"&gt;the&lt;/span&gt; &lt;span class="nx"&gt;parameters&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt; &lt;span class="nx"&gt;distros&lt;/span&gt; &lt;span class="nx"&gt;underlying&lt;/span&gt; &lt;span class="nx"&gt;profile&lt;/span&gt; &lt;span class="nx"&gt;confidence&lt;/span&gt; &lt;span class="nx"&gt;intervals&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nx"&gt;linear&lt;/span&gt; &lt;span class="nx"&gt;zeta&lt;/span&gt; &lt;span class="nx"&gt;plot&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;==&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;gaussian&lt;/span&gt; &lt;span class="nx"&gt;densities&lt;/span&gt;

&lt;span class="nx"&gt;lattice&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="nx"&gt;splom&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;m1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prre&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/pairs-plot-1.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;# the &amp;#39;profile pairs plot&amp;#39;
# bivariate confidence regions based on profile
# &amp;#39;profile traces&amp;#39; -- cross hairs -- are conditional estimates  of one parameter given the other
# above-diag: estimated scale
# below-diag: &amp;#39;zeta&amp;#39; scale, some sense, the best possible set of single-parameter transformations for assessing the contours&amp;quot;
# we just look at RE here
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Implications -- lsmeans&lt;/h2&gt;
&lt;p&gt;Understanding a complex model with high-order interactions is tough. The
best tool is plotting, but quickly visualizing such models is not easy
with flexible plotting libraries.&lt;/p&gt;
&lt;p&gt;Fortunately, &lt;code&gt;lsmeans&lt;/code&gt;, although fairly inflexible in general, has
plotting capabilities designed just for this purpose. Here's a demo with
the full (4-way interacting) model&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="nx"&gt;look&lt;/span&gt; &lt;span class="nx"&gt;at&lt;/span&gt; &lt;span class="nx"&gt;consequences&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;lsmeans&lt;/span&gt;&lt;span class="p"&gt;)){&lt;/span&gt;
    &lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="nx"&gt;here&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;way&lt;/span&gt; &lt;span class="nx"&gt;interaction&lt;/span&gt; &lt;span class="nx"&gt;model&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;m2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt; &lt;span class="nx"&gt;mostly&lt;/span&gt; &lt;span class="nx"&gt;to&lt;/span&gt; &lt;span class="nx"&gt;see&lt;/span&gt; &lt;span class="nx"&gt;how&lt;/span&gt; &lt;span class="nx"&gt;can&lt;/span&gt; &lt;span class="nx"&gt;quickly&lt;/span&gt; &lt;span class="nx"&gt;plot&lt;/span&gt; &lt;span class="nx"&gt;response&lt;/span&gt;
    &lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="nx"&gt;at&lt;/span&gt; &lt;span class="nx"&gt;factor&lt;/span&gt; &lt;span class="nx"&gt;levels&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nx"&gt;complex&lt;/span&gt; &lt;span class="nx"&gt;models&lt;/span&gt;
    &lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="nx"&gt;relatively&lt;/span&gt; &lt;span class="nx"&gt;easy&lt;/span&gt; &lt;span class="nx"&gt;to&lt;/span&gt; &lt;span class="nx"&gt;plot&lt;/span&gt; &lt;span class="nx"&gt;mean&lt;/span&gt; &lt;span class="nx"&gt;prediction&lt;/span&gt; &lt;span class="nx"&gt;on&lt;/span&gt; &lt;span class="nx"&gt;response&lt;/span&gt; &lt;span class="nx"&gt;scale&lt;/span&gt; &lt;span class="nx"&gt;account&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nx"&gt;complex&lt;/span&gt; &lt;span class="nx"&gt;interaction&lt;/span&gt;
    &lt;span class="nx"&gt;lsmip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;m2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;nutrient_hetero&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;  &lt;span class="nx"&gt;water_add&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nx"&gt;water_hetero&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nx"&gt;nutrient_add&lt;/span&gt;  &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;response&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nx"&gt;lsmip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;m2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;water_add&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; &lt;span class="nx"&gt;nutrient_add&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nx"&gt;water_hetero&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nx"&gt;nutrient_hetero&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;response&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nx"&gt;lsmip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;m2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;water_add&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; &lt;span class="nx"&gt;water_hetero&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nx"&gt;nutrient_add&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nx"&gt;nutrient_hetero&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;response&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="nx"&gt;Note&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;method&lt;/span&gt; &lt;span class="kd"&gt;with&lt;/span&gt; &lt;span class="nx"&gt;signature&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;sparseMatrix#ANY&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;chosen&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;kronecker&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="err"&gt;##&lt;/span&gt;  &lt;span class="nx"&gt;target&lt;/span&gt; &lt;span class="nx"&gt;signature&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;dgCMatrix#ngCMatrix&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="err"&gt;##&lt;/span&gt;  &lt;span class="s2"&gt;&amp;quot;ANY#sparseMatrix&amp;quot;&lt;/span&gt; &lt;span class="nx"&gt;would&lt;/span&gt; &lt;span class="nx"&gt;also&lt;/span&gt; &lt;span class="nx"&gt;be&lt;/span&gt; &lt;span class="nx"&gt;valid&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/use-lsmeans-mean-plots-1.svg" /&gt;
&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/use-lsmeans-mean-plots-2.svg" /&gt;
&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/use-lsmeans-mean-plots-3.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kr"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kn"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;lsmeans&lt;span class="p"&gt;)){&lt;/span&gt;
    &lt;span class="c1"&gt;## can also plot quickly mean estimates plus (Wald) confidence intervals&lt;/span&gt;
    &lt;span class="c1"&gt;## not that it&amp;#39;s possible to do finite size correction in lsmeans (but only for linear models)&lt;/span&gt;
    &lt;span class="c1"&gt;## steps take a min w/ lots of RE for some reason&lt;/span&gt;
    m2.lsm &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; lsmeans&lt;span class="p"&gt;(&lt;/span&gt;m2&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; water_add &lt;span class="o"&gt;*&lt;/span&gt; water_hetero   &lt;span class="o"&gt;|&lt;/span&gt; nutrient_hetero  &lt;span class="o"&gt;*&lt;/span&gt; nutrient_add&lt;span class="p"&gt;)&lt;/span&gt;
    plot&lt;span class="p"&gt;(&lt;/span&gt;m2.lsm&lt;span class="p"&gt;,&lt;/span&gt; layout &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; horizontal&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/ls-means-CI-plots-1.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;    &lt;span class="c1"&gt;## for the simpler&lt;/span&gt;
    lsmip&lt;span class="p"&gt;(&lt;/span&gt;m1&lt;span class="p"&gt;,&lt;/span&gt; nutrient_hetero &lt;span class="o"&gt;~&lt;/span&gt;  water_add &lt;span class="o"&gt;|&lt;/span&gt; water_hetero &lt;span class="o"&gt;*&lt;/span&gt; nutrient_add  &lt;span class="p"&gt;,&lt;/span&gt; type&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;response&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    lsmip&lt;span class="p"&gt;(&lt;/span&gt;m1&lt;span class="p"&gt;,&lt;/span&gt; water_add &lt;span class="o"&gt;~&lt;/span&gt; nutrient_add  &lt;span class="o"&gt;|&lt;/span&gt; water_hetero &lt;span class="o"&gt;*&lt;/span&gt; nutrient_hetero&lt;span class="p"&gt;,&lt;/span&gt; type&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;response&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    lsmip&lt;span class="p"&gt;(&lt;/span&gt;m1&lt;span class="p"&gt;,&lt;/span&gt; water_add &lt;span class="o"&gt;~&lt;/span&gt; water_hetero  &lt;span class="o"&gt;|&lt;/span&gt; nutrient_add &lt;span class="o"&gt;*&lt;/span&gt; nutrient_hetero&lt;span class="p"&gt;,&lt;/span&gt; type&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;response&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;## overall pattern doesn&amp;#39;t differ too much from m1&lt;/span&gt;
    m1.lsm &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; lsmeans&lt;span class="p"&gt;(&lt;/span&gt;m1&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; water_add &lt;span class="o"&gt;*&lt;/span&gt; water_hetero   &lt;span class="o"&gt;|&lt;/span&gt; nutrient_hetero  &lt;span class="o"&gt;*&lt;/span&gt; nutrient_add&lt;span class="p"&gt;)&lt;/span&gt;
    plot&lt;span class="p"&gt;(&lt;/span&gt;m1.lsm&lt;span class="p"&gt;,&lt;/span&gt; layout &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; horizontal&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Confidence intervals&lt;/h1&gt;
&lt;h2&gt;quick &amp;amp; dirty&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="nx"&gt;OK&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt; &lt;span class="nx"&gt;back&lt;/span&gt; &lt;span class="nx"&gt;to&lt;/span&gt; &lt;span class="nx"&gt;the&lt;/span&gt; &lt;span class="nx"&gt;full&lt;/span&gt; &lt;span class="nx"&gt;model&lt;/span&gt;
&lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;residuals&lt;/span&gt; &lt;span class="nx"&gt;looking&lt;/span&gt; &lt;span class="nx"&gt;OK&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt; &lt;span class="nx"&gt;fastest&lt;/span&gt; &lt;span class="nx"&gt;way&lt;/span&gt; &lt;span class="nx"&gt;to&lt;/span&gt; &lt;span class="nx"&gt;get&lt;/span&gt; &lt;span class="nx"&gt;a&lt;/span&gt; &lt;span class="nx"&gt;quick&lt;/span&gt; &lt;span class="nx"&gt;look&lt;/span&gt; &lt;span class="nx"&gt;at&lt;/span&gt; &lt;span class="nx"&gt;coefficient&lt;/span&gt; &lt;span class="nx"&gt;uncertainty&lt;/span&gt;
&lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="nx"&gt;I&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ll make it a function for later use&lt;/span&gt;

&lt;span class="s1"&gt;quick_CI_df &amp;lt;- function(model, drop_intercept = TRUE,...) {&lt;/span&gt;
&lt;span class="s1"&gt;  ## coef table using WALD CIs for a merMod&lt;/span&gt;
&lt;span class="s1"&gt;  ci_dat &amp;lt;- confint(model, method=&amp;#39;&lt;/span&gt;&lt;span class="nx"&gt;Wald&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;, ...)&lt;/span&gt;
&lt;span class="s1"&gt;  ci_dat &amp;lt;- cbind(ci_dat, mean=rowMeans(ci_dat))&lt;/span&gt;
&lt;span class="s1"&gt;  ci_df &amp;lt;- data.frame(coef=row.names(ci_dat), ci_dat)&lt;/span&gt;
&lt;span class="s1"&gt;  names(ci_df)&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="s1"&gt; &amp;lt;- c(&amp;#39;&lt;/span&gt;&lt;span class="nx"&gt;lwr&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;&lt;span class="nx"&gt;upr&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;)&lt;/span&gt;
&lt;span class="s1"&gt;  coef_colon &amp;lt;-   gregexpr(&amp;quot;\\:&amp;quot;, ci_df$coef)&lt;/span&gt;
&lt;span class="s1"&gt;  coef_order &amp;lt;- sapply(coef_colon, function(x) {&lt;/span&gt;
&lt;span class="s1"&gt;    if(x&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="s1"&gt; == -1)&lt;/span&gt;
&lt;span class="s1"&gt;      return(0)&lt;/span&gt;
&lt;span class="s1"&gt;    else&lt;/span&gt;
&lt;span class="s1"&gt;      return(length(x))&lt;/span&gt;
&lt;span class="s1"&gt;  })&lt;/span&gt;
&lt;span class="s1"&gt;  ci_df$coef &amp;lt;- reorder(ci_df$coef, coef_order)&lt;/span&gt;
&lt;span class="s1"&gt;  if (drop_intercept)&lt;/span&gt;
&lt;span class="s1"&gt;    return(subset(ci_df, coef != &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;Intercept&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="nx"&gt;ci_df&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nx"&gt;m1_wald_ci&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;quick_CI_df&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;m2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nx"&gt;lattice&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="nx"&gt;dotplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;coef&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; &lt;span class="nx"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;m1_wald_ci&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="nx"&gt;panel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                   &lt;span class="nx"&gt;panel&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;xyplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;pch&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                   &lt;span class="nx"&gt;panel&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;segments&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;m1_wald_ci$lwr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;m1_wald_ci$upr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                   &lt;span class="nx"&gt;panel&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;abline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;lty&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                 &lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/confint-lattice-1.svg" /&gt;&lt;/p&gt;
&lt;h2&gt;Confidence Intervals -- rolling your own&lt;/h2&gt;
&lt;p&gt;For more control than the simple plot above, you could use any of a
variety of packages, e.g. &lt;code&gt;coefplot2&lt;/code&gt;, &lt;code&gt;arm::coefplot&lt;/code&gt;, here we just use
builtin &lt;code&gt;lme4::confint&lt;/code&gt; to build a dataframe.&lt;/p&gt;
&lt;p&gt;I make a dataframe with potentially several different types of
confidence intervals: Wald (assume asymptotic multivariate normality of
likelihood), profile, and bootstrap. For the random effects, the output
of bootstrap and profile methods have different names -- as you can see
in the plot below. The Wald method only estimates CIs for fixed effects.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nx"&gt;compare_CI_df&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;modprof&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;model&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;BOOT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;FALSE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nx"&gt;ci&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;confint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;model&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;method&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Wald&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="nx"&gt;cip&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;confint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;modprof&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;BOOT&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="nx"&gt;cib&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;confint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;model&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;method&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;boot&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...)&lt;/span&gt;
      &lt;span class="nx"&gt;cib_dat&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cib&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;parameter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;row&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cib&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Boot&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="nx"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cib_dat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;colnames&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cib&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="nx"&gt;ci_dat&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ci&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;parameter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;row&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ci&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Wald&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="nx"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ci_dat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;colnames&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ci&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="nx"&gt;cip_dat&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cip&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;parameter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;row&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cip&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Prof&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="nx"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cip_dat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;colnames&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cip&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="nx"&gt;BOOT&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="nx"&gt;ci_all_dat&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;rbind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ci_dat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;cip_dat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="nx"&gt;ci_all_dat&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;rbind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ci_dat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;cip_dat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;cib_dat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="nx"&gt;fe_dat&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;parameter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;fixef&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;model&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt; &lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;fixef&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;model&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="nx"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;mean&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;fe_dat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;bounds&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;ci_all_dat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ggplot2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;m1_ci&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;compare_CI_df&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;m1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prall&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;m1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;BOOT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;nsim&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nx"&gt;m1_mean&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;m1_ci&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="nx"&gt;m1_bnd&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;m1_ci&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;bounds&amp;#39;&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

    &lt;span class="nx"&gt;ggplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;m1_bnd&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;m1_bnd&lt;/span&gt;&lt;span class="nv"&gt;$parameter&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;(Intercept)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
    &lt;span class="nx"&gt;geom_linerange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;aes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;parameter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;ymax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="mf"&gt;97.5&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;ymin&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                   &lt;span class="nx"&gt;position&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;position_dodge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;w&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nx"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
    &lt;span class="nx"&gt;geom_hline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;yintercept&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;linetype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
    &lt;span class="nx"&gt;coord_flip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;theme_minimal&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
    &lt;span class="nx"&gt;geom_point&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;aes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;parameter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nx"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
               &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;m1_mean&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;m1_mean&lt;/span&gt;&lt;span class="nv"&gt;$parameter&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;(Intercept)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;lattice&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="nx"&gt;dotplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;parameter&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; &lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="mf"&gt;97.5&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;m1_bnd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;abline&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;lty&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="nx"&gt;Computing&lt;/span&gt; &lt;span class="nx"&gt;bootstrap&lt;/span&gt; &lt;span class="nx"&gt;confidence&lt;/span&gt; &lt;span class="nx"&gt;intervals&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;

&lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="nx"&gt;Warning&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;Removed&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="nx"&gt;rows&lt;/span&gt; &lt;span class="nx"&gt;containing&lt;/span&gt; &lt;span class="nx"&gt;missing&lt;/span&gt; &lt;span class="nx"&gt;values&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;geom_segment&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;

&lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="nx"&gt;Warning&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;Removed&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="nx"&gt;rows&lt;/span&gt; &lt;span class="nx"&gt;containing&lt;/span&gt; &lt;span class="nx"&gt;missing&lt;/span&gt; &lt;span class="nx"&gt;values&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;geom_segment&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/ryo-1.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;##   strong effect of nutrient homogeneity
##   effect of adding lots of water
## nutrient has some effect
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Pulling data out of models with &lt;code&gt;broom&lt;/code&gt; or &lt;code&gt;ggplot2&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Method &lt;code&gt;ggplot2::fortify&lt;/code&gt; adds fitted and resid to data frame. New-ish
CRAN package &lt;code&gt;broom&lt;/code&gt; generalizes this (and more), really aiming provide
an interface for 'tidy' (i.e., easy to plot)representations of model
objects from many R functions (including packages and base &lt;code&gt;R&lt;/code&gt;). The
&lt;code&gt;broom&lt;/code&gt; method &lt;code&gt;augment&lt;/code&gt; really generalized version of &lt;code&gt;fortify&lt;/code&gt; and is
recommended instead&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kr"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kn"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;ggplot2&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    d_fort &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; ggplot2&lt;span class="o"&gt;::&lt;/span&gt;fortify&lt;span class="p"&gt;(&lt;/span&gt;m1&lt;span class="p"&gt;,&lt;/span&gt; d&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;## adds .fortify, scresid, .resid&lt;/span&gt;
    &lt;span class="c1"&gt;##head(d_fort)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kr"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kn"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;broom&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    glm1 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; glance&lt;span class="p"&gt;(&lt;/span&gt;m1&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# model summary&lt;/span&gt;
    tdm1 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; tidy&lt;span class="p"&gt;(&lt;/span&gt;m1&lt;span class="p"&gt;,&lt;/span&gt; effects&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;fixed&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;#model coefficient summary&lt;/span&gt;
    augm1 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; augment&lt;span class="p"&gt;(&lt;/span&gt;m1&lt;span class="p"&gt;,&lt;/span&gt; d&lt;span class="p"&gt;,&lt;/span&gt; se.fit&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; type.predict&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;response&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# model data with fits&lt;/span&gt;
    &lt;span class="c1"&gt;## head(glm1)&lt;/span&gt;
    &lt;span class="c1"&gt;## head(tdm1)&lt;/span&gt;
    &lt;span class="c1"&gt;## head(augm1)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Unfortunately, the predict and confint methods for &lt;code&gt;merMod&lt;/code&gt; aren't yet
integrated to &lt;code&gt;broom&lt;/code&gt; or &lt;code&gt;ggplot&lt;/code&gt; (or my code above for confidence
intervals could be much cleaner at the slight cost of an additional
package dependency).&lt;/p&gt;
&lt;h2&gt;GLMM: Lizard mate choice&lt;/h2&gt;
&lt;p&gt;Mechanisms of speciation -- cool question!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;mate compatibility trails&lt;/li&gt;
&lt;li&gt;western North American skinks (&lt;em&gt;Plestiodon skiltonianus&lt;/em&gt; spp)&lt;/li&gt;
&lt;li&gt;Richmond, J. Q., E. L. Jockusch, and A. M. Latimer 2010. Mechanical
    reproductive isolation facilitates parallel speciation in western
    North American scincid lizards. &lt;em&gt;American Naturalist&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Repeated measure of ind crossed with multiple trials, binary outcome&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;d2 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; read.delim&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://datadryad.org/bitstream/handle/10255/dryad.33579/Richmond%20et%20al%202011%20Datafile.txt?sequence=1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;d2&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;gsub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;\\.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kp"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;d2&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="c1"&gt;# rescale geo dist, sizediff&lt;/span&gt;
d2 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;within&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;d2&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    geodist_scl &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;GeoDist &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="kp"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;GeoDist&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; var&lt;span class="p"&gt;(&lt;/span&gt;GeoDist&lt;span class="p"&gt;)&lt;/span&gt;
    gendist_scl &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;GenDist &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="kp"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;GenDist&lt;span class="p"&gt;))&lt;/span&gt;
    sizediff_scl2 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;SizeDiff &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="kp"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;SizeDiff&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; var&lt;span class="p"&gt;(&lt;/span&gt;SizeDiff&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;
    Series &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;factor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Series&lt;span class="p"&gt;)&lt;/span&gt;
    Female &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;factor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Female&lt;span class="p"&gt;)&lt;/span&gt;
    Male &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;factor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Male&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;})&lt;/span&gt;

&lt;span class="c1"&gt;## cop - copulation&lt;/span&gt;
&lt;span class="kp"&gt;system.time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;gm0 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; glmer&lt;span class="p"&gt;(&lt;/span&gt;cop &lt;span class="o"&gt;~&lt;/span&gt;   sizediff_scl2   &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; Series&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; Male&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; Female&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt;
               data&lt;span class="o"&gt;=&lt;/span&gt;d2&lt;span class="p"&gt;,&lt;/span&gt; family&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;binomial&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="c1"&gt;##    user  system elapsed &lt;/span&gt;
&lt;span class="c1"&gt;##   0.602   0.004   0.685&lt;/span&gt;

&lt;span class="kp"&gt;system.time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;gm1 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; glmer&lt;span class="p"&gt;(&lt;/span&gt;cop &lt;span class="o"&gt;~&lt;/span&gt; gendist_scl &lt;span class="o"&gt;+&lt;/span&gt; geodist_scl &lt;span class="o"&gt;+&lt;/span&gt;  sizediff_scl2 &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; Series&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
                         &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; Male&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; Female&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; data&lt;span class="o"&gt;=&lt;/span&gt;d2&lt;span class="p"&gt;,&lt;/span&gt; family&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;binomial&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="c1"&gt;## Warning in checkConv(attr(opt, &amp;quot;derivs&amp;quot;), opt$par, ctrl = control&lt;/span&gt;
&lt;span class="c1"&gt;## $checkConv, : unable to evaluate scaled gradient&lt;/span&gt;

&lt;span class="c1"&gt;## Warning in checkConv(attr(opt, &amp;quot;derivs&amp;quot;), opt$par, ctrl = control&lt;/span&gt;
&lt;span class="c1"&gt;## $checkConv, : Hessian is numerically singular: parameters are not uniquely&lt;/span&gt;
&lt;span class="c1"&gt;## determined&lt;/span&gt;

&lt;span class="c1"&gt;##    user  system elapsed &lt;/span&gt;
&lt;span class="c1"&gt;##   1.489   0.007   1.498&lt;/span&gt;

anova&lt;span class="p"&gt;(&lt;/span&gt;gm1&lt;span class="p"&gt;,&lt;/span&gt; gm0&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# no need for non-size predictors&lt;/span&gt;

&lt;span class="c1"&gt;## Data: d2&lt;/span&gt;
&lt;span class="c1"&gt;## Models:&lt;/span&gt;
&lt;span class="c1"&gt;## gm0: cop ~ sizediff_scl2 + (1 | Series) + (1 | Male) + (1 | Female)&lt;/span&gt;
&lt;span class="c1"&gt;## gm1: cop ~ gendist_scl + geodist_scl + sizediff_scl2 + (1 | Series) + &lt;/span&gt;
&lt;span class="c1"&gt;## gm1:     (1 | Male) + (1 | Female)&lt;/span&gt;
&lt;span class="c1"&gt;##     Df    AIC    BIC  logLik deviance  Chisq Chi Df Pr(&amp;gt;Chisq)&lt;/span&gt;
&lt;span class="c1"&gt;## gm0  5 159.34 176.47 -74.673   149.34                         &lt;/span&gt;
&lt;span class="c1"&gt;## gm1  7 162.92 186.90 -74.460   148.92 0.4251      2     0.8085&lt;/span&gt;

plot&lt;span class="p"&gt;(&lt;/span&gt;gm0&lt;span class="p"&gt;,&lt;/span&gt; type&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;p&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; id &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;0.05&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;## Warning in if (as.character(grps) == &amp;quot;.obs&amp;quot;) return(seq(fitted(object))):&lt;/span&gt;
&lt;span class="c1"&gt;## the condition has length &amp;gt; 1 and only the first element will be used&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/lizard-crit-1.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;## non useful visually but with id = 0.05 gives sense of outlier
## see ?plot.merMod for explanation of test run

## it&amp;#39;s more useful to plot residuals in GLM logistic combined across grouping factors
## or binned fitted values
plot(gm0,  factor(Trial) ~ resid(., type=&amp;#39;pearson&amp;#39;),  abline=c(v=0), lty=2)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/lizard-crit-2.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;plot(gm0,  factor(Series) ~ resid(., type=&amp;#39;pearson&amp;#39;),  abline=c(v=0), lty=2)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/lizard-crit-3.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;## better than default eh

## second plot suggests some issue with series, indicating we may want to
## fit a model accounting for differences between trial series
## (in fact, Richmond et al did fit such a model)
## you can see the outliers here too with
## plot(gm0, resid(., type=&amp;#39;pearson&amp;#39;) ~ fitted(.) | factor(Series), id = 0.05)

## main thing on pearson or deviance residuals is they&amp;#39;re mostly less than 2
## (as assessed in first plot above -- second is the sqrt
## we could later drop these outlier and see if they change

if(require(gridExtra)) {
    do.call(gridExtra::grid.arrange, c(lattice::qqmath(ranef(gm0, condVar=TRUE)), list(nrow=1)))
} else {
    lattice::qqmath(ranef(gm0, condVar=TRUE))
  }
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/lizard-crit-4.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;## useful if you have a lot of RE to draw attention to strong ones&lt;/span&gt;
&lt;span class="c1"&gt;## maybe latter == dot = sample size?&lt;/span&gt;

&lt;span class="c1"&gt;## no reason to retain RE on Male, but also drop Female&lt;/span&gt;
&lt;span class="c1"&gt;## no real justification, just very slow profiling for many RE&lt;/span&gt;
gm0noindre &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; glmer&lt;span class="p"&gt;(&lt;/span&gt;cop &lt;span class="o"&gt;~&lt;/span&gt;   sizediff_scl2   &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; Series&lt;span class="p"&gt;),&lt;/span&gt; data&lt;span class="o"&gt;=&lt;/span&gt;d2&lt;span class="p"&gt;,&lt;/span&gt; family&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;binomial&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kp"&gt;system.time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="c1"&gt;#&lt;/span&gt;
    gm0.prall &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; profile&lt;span class="p"&gt;(&lt;/span&gt;gm0noindre&lt;span class="p"&gt;,&lt;/span&gt; devtol&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1e-6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# see https://stat.ethz.ch/pipermail/r-sig-mixed-models/2014q3/022394.html&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;##    user  system elapsed &lt;/span&gt;
&lt;span class="c1"&gt;##  10.312   0.046  10.406&lt;/span&gt;

&lt;span class="c1"&gt;#system.time(&lt;/span&gt;
&lt;span class="c1"&gt;#    gm0_full.prall &amp;lt;- profile(gm0, devtol=1e-6)&lt;/span&gt;
&lt;span class="c1"&gt;#)&lt;/span&gt;
&lt;span class="c1"&gt;#   user  system elapsed&lt;/span&gt;
&lt;span class="c1"&gt;#344.092   0.539 344.613&lt;/span&gt;

lattice&lt;span class="o"&gt;::&lt;/span&gt;xyplot&lt;span class="p"&gt;(&lt;/span&gt;logProf&lt;span class="p"&gt;(&lt;/span&gt;gm0.prall&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/lizard-plotting-1.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;lattice::densityplot(gm0.prall)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/lizard-plotting-2.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;lattice::splom(gm0.prall)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/lizard-plotting-3.svg" /&gt;&lt;/p&gt;
&lt;h1&gt;Confidence intervals&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;residuals&lt;/span&gt; &lt;span class="nx"&gt;looking&lt;/span&gt; &lt;span class="nx"&gt;OK&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt; &lt;span class="nx"&gt;fastest&lt;/span&gt; &lt;span class="nx"&gt;way&lt;/span&gt; &lt;span class="nx"&gt;to&lt;/span&gt; &lt;span class="nx"&gt;get&lt;/span&gt; &lt;span class="nx"&gt;a&lt;/span&gt; &lt;span class="nx"&gt;quick&lt;/span&gt; &lt;span class="nx"&gt;look&lt;/span&gt; &lt;span class="nx"&gt;at&lt;/span&gt; &lt;span class="nx"&gt;coefficient&lt;/span&gt; &lt;span class="nx"&gt;uncertainty&lt;/span&gt;
&lt;span class="nx"&gt;ci_dat&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;confint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;gm0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;method&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Wald&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nx"&gt;ci_dat&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;cbind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ci_dat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;mean&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;rowMeans&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ci_dat&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="nx"&gt;ci_df&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;coef&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;row&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ci_dat&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nx"&gt;ci_dat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nx"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ci_df&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;lwr&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;upr&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="nx"&gt;lattice&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="nx"&gt;dotplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;coef&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; &lt;span class="nx"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;ci_df&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;panel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;panel&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;xyplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;pch&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="nx"&gt;panel&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;segments&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ci_df$lwr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;ci_df$upr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="nx"&gt;panel&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;abline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;lty&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/quick-ci-1.svg" /&gt;&lt;/p&gt;
&lt;p&gt;Rolling your own again&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kr"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kn"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;ggplot2&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  gm0_ci &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; compare_CI_df&lt;span class="p"&gt;(&lt;/span&gt;gm0.prall&lt;span class="p"&gt;,&lt;/span&gt; gm0&lt;span class="p"&gt;)&lt;/span&gt;
  gm0_mean &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; gm0_ci&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
  gm0_bnd &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; gm0_ci&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;bounds&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
  g &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class="p"&gt;(&lt;/span&gt;gm0_bnd&lt;span class="p"&gt;[&lt;/span&gt;gm0_bnd&lt;span class="o"&gt;$&lt;/span&gt;parameter &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;(Intercept)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
    geom_linerange&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;parameter&lt;span class="p"&gt;,&lt;/span&gt; ymax&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`97.5 %`&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; ymin&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`2.5 %`&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; color&lt;span class="o"&gt;=&lt;/span&gt;type&lt;span class="p"&gt;),&lt;/span&gt;
                   position&lt;span class="o"&gt;=&lt;/span&gt;position_dodge&lt;span class="p"&gt;(&lt;/span&gt;w&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;.5&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; size&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
    geom_hline&lt;span class="p"&gt;(&lt;/span&gt;yintercept&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; linetype&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
    coord_flip&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; theme_minimal&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
    geom_point&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;parameter&lt;span class="p"&gt;,&lt;/span&gt; value&lt;span class="p"&gt;),&lt;/span&gt;
               size&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; shape&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
               data&lt;span class="o"&gt;=&lt;/span&gt;gm0_mean&lt;span class="p"&gt;[&lt;/span&gt;gm0_mean&lt;span class="o"&gt;$&lt;/span&gt;parameter &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;(Intercept)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;])&lt;/span&gt;
  g
  &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="kr"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    lattice&lt;span class="o"&gt;::&lt;/span&gt;dotplot&lt;span class="p"&gt;(&lt;/span&gt;parameter &lt;span class="o"&gt;~&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sb"&gt;`2.5 %`&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sb"&gt;`97.5 %`&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; type &lt;span class="p"&gt;,&lt;/span&gt; gm0_bnd&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/ryo-lizard-ci-1.svg" /&gt;&lt;/p&gt;
&lt;p&gt;Because the fixed effect parameter on size difference and the random
effect variance are on such different scales, I make two plots&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;if(require(ggplot2))
    g + scale_y_log10()
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/low-magnitude-param-1.svg" /&gt;&lt;/p&gt;
&lt;h2&gt;quick predictions&lt;/h2&gt;
&lt;p&gt;Again, the quickest way to visualize predictions is with &lt;code&gt;lsmeans&lt;/code&gt;. Two
things are different here:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;to plot GLM predictions on a meaningful scale, you need to pass
    &lt;code&gt;type = 'response'&lt;/code&gt; to the &lt;code&gt;plot&lt;/code&gt; function.&lt;/li&gt;
&lt;li&gt;for a quantitative predictor, the default will plot a single point
    at the mean of the predictor, to see prediction across the range,
    pass a list to the &lt;code&gt;at&lt;/code&gt; argument&lt;/li&gt;
&lt;li&gt;for more meaningful plots, we should label the plot y-axis with
    unscaled size differences (but I didn't do this)&lt;/li&gt;
&lt;li&gt;note that you can produce plots at various levels of interacting
    quantitative predictors using this technique&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- --&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kr"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kn"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;lsmeans&lt;span class="p"&gt;))&lt;/span&gt;

gm0_lsm &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt;    lsmeans&lt;span class="p"&gt;(&lt;/span&gt;gm0&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; sizediff_scl2&lt;span class="p"&gt;,&lt;/span&gt;
                  at &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kt"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;sizediff_scl2 &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kp"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;from&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                              to &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1.5&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; median&lt;span class="p"&gt;(&lt;/span&gt;d2&lt;span class="o"&gt;$&lt;/span&gt;sizediff_scl2&lt;span class="p"&gt;),&lt;/span&gt; length.out &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;

plot&lt;span class="p"&gt;(&lt;/span&gt;gm0_lsm&lt;span class="p"&gt;,&lt;/span&gt; type &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;response&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; ylab &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;scaled size diff&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; xlab &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;probability of copulation&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/quick-vis-glmm-1.svg" /&gt;
## customized predictions&lt;/p&gt;
&lt;p&gt;The quick plots using &lt;code&gt;lsmeans&lt;/code&gt; are great, but they assume Wald
confidence intervals and don't account for random effects. To deal with
the former, we need to bootstrap, which I won't cover here, but the
problem of random effects is easily examined using the &lt;code&gt;re.form&lt;/code&gt;
argument of &lt;code&gt;predict.merMod&lt;/code&gt; in &lt;code&gt;lme4&lt;/code&gt;. Here I look at predictions
accounting for all,, none, or some of random effects fitted:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;## predicted effect&lt;/span&gt;
d2&lt;span class="o"&gt;$&lt;/span&gt;pred_overall_gen &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; predict&lt;span class="p"&gt;(&lt;/span&gt;gm0&lt;span class="p"&gt;,&lt;/span&gt; type&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;response&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; re.form&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;NA&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
d2&lt;span class="o"&gt;$&lt;/span&gt;pred_overall &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; predict&lt;span class="p"&gt;(&lt;/span&gt;gm0&lt;span class="p"&gt;,&lt;/span&gt; type&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;response&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
d2&lt;span class="o"&gt;$&lt;/span&gt;pred_ind &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; predict&lt;span class="p"&gt;(&lt;/span&gt;gm0&lt;span class="p"&gt;,&lt;/span&gt; type&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;response&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; re.form&lt;span class="o"&gt;=~&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;Female&lt;span class="p"&gt;))&lt;/span&gt;
d2&lt;span class="o"&gt;$&lt;/span&gt;pred_trial &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; predict&lt;span class="p"&gt;(&lt;/span&gt;gm0&lt;span class="p"&gt;,&lt;/span&gt; type&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;response&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; re.form&lt;span class="o"&gt;=~&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;Series&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="c1"&gt;## NB this changes row order from the fit!!!&lt;/span&gt;
d2_pred &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;merge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;d2&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kp"&gt;as.data.frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Series&lt;span class="o"&gt;=&lt;/span&gt;d2&lt;span class="o"&gt;$&lt;/span&gt;Series&lt;span class="p"&gt;)))&lt;/span&gt;

&lt;span class="kr"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kn"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;ggplot2&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;

g &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class="p"&gt;(&lt;/span&gt;d2_pred&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
     geom_point&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;SizeDiff&lt;span class="p"&gt;,&lt;/span&gt; cop&lt;span class="p"&gt;),&lt;/span&gt;
                position&lt;span class="o"&gt;=&lt;/span&gt;position_jitter&lt;span class="p"&gt;(&lt;/span&gt;h&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0.025&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; w&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
     theme_minimal&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
     ylab&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Probability copulation&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


g1 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; g &lt;span class="o"&gt;+&lt;/span&gt; geom_line&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;SizeDiff&lt;span class="p"&gt;,&lt;/span&gt; pred_trial&lt;span class="p"&gt;,&lt;/span&gt; color&lt;span class="o"&gt;=&lt;/span&gt;Series&lt;span class="p"&gt;))&lt;/span&gt;

g2 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; g &lt;span class="o"&gt;+&lt;/span&gt; geom_line&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;SizeDiff&lt;span class="p"&gt;,&lt;/span&gt; pred_overall_gen&lt;span class="p"&gt;),&lt;/span&gt; color&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;orange&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; size &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
    geom_point&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;SizeDiff&lt;span class="p"&gt;,&lt;/span&gt; pred_ind&lt;span class="p"&gt;,&lt;/span&gt; alpha&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kp"&gt;as.numeric&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Female&lt;span class="p"&gt;)),&lt;/span&gt; color &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;blue&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
    theme&lt;span class="p"&gt;(&lt;/span&gt;legend.position &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;none&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

gridExtra&lt;span class="o"&gt;::&lt;/span&gt;grid.arrange&lt;span class="p"&gt;(&lt;/span&gt;g1&lt;span class="p"&gt;,&lt;/span&gt; g2&lt;span class="p"&gt;,&lt;/span&gt; ncol&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="kr"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    plot&lt;span class="p"&gt;(&lt;/span&gt;cop &lt;span class="o"&gt;~&lt;/span&gt; SizeDiff&lt;span class="p"&gt;,&lt;/span&gt; d2_pred&lt;span class="p"&gt;,&lt;/span&gt; ylab&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Probability copulation&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    points&lt;span class="p"&gt;(&lt;/span&gt;pred_ind &lt;span class="o"&gt;~&lt;/span&gt; SizeDiff&lt;span class="p"&gt;,&lt;/span&gt; d2_pred&lt;span class="p"&gt;,&lt;/span&gt; pch&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; cex&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; col&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;darkgray&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    points&lt;span class="p"&gt;(&lt;/span&gt;pred_overall_gen &lt;span class="o"&gt;~&lt;/span&gt; SizeDiff&lt;span class="p"&gt;,&lt;/span&gt; d2_pred&lt;span class="p"&gt;,&lt;/span&gt; pch&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; cex&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/prediction-visual-1.svg" /&gt;&lt;/p&gt;
&lt;p&gt;The plot on the left above shows predictions for various series of
experimental trials, and the raw data. The plot on the right shows the
overall fit (orange line -- the grand mean with no random effects
influencing the prediction), the predictions accounting just for random
effects at the level of individual females (blue dots), and the raw
data.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;## could plot them all together -- code below gives some insight ## into the
## ggplot2 fortify method
if (require(ggplot2)) {
  g +  geom_point(aes(SizeDiff, plogis(.fitted)), color=&amp;#39;darkgray&amp;#39;, size=3,
                  data=fortify(gm0, d2))

## nb -- same as predict with all RE!
  with(fortify(gm0, d2),
       unique(pred_overall - plogis(.fitted)))
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Checking model adequacy&lt;/h2&gt;
&lt;p&gt;With `&lt;code&gt;lme4&lt;/code&gt;, you can also easily produce something akin to
posterior-predictive checks, &lt;a href="http://andrewgelman.com/2014/08/11/discussion-sander-greenland-posterior-predictive-checks/"&gt;a Bayesian
tool&lt;/a&gt;
for model criticism.&lt;/p&gt;
&lt;p&gt;Using &lt;code&gt;simulate&lt;/code&gt; on an &lt;code&gt;lme4&lt;/code&gt; produces a set of response data implied by
the model. By examining summary statistics of this dataset, and
comparing them to the actual data, you can examine how well, or poorly,
the model fits. Note that these checks are less rigorous than something
like cross-validation. See &lt;code&gt;?simulate.merMod&lt;/code&gt; for additional
information.&lt;/p&gt;
&lt;p&gt;The upshot: these are relatively quick, and can provide a warning that
your model isn't capturing some aspect of the data. But, be aware there
is controversy about their use for anything other than seeing how the
model is capturing the data. Often, we're interested in making more
formal, frequentist inference. Though these checks are valuable, the
p-like-values implied by them &lt;a href="http://andrewgelman.com/2009/02/07/confusions_abou/"&gt;do not satisfy assumptions necessary for
this kind of
inference&lt;/a&gt; (i.e.,
don't use them for model comparison or parameter inference).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="nx"&gt;without&lt;/span&gt; &lt;span class="nx"&gt;RE&lt;/span&gt;
&lt;span class="nx"&gt;set&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;seed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1141&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nx"&gt;gm0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;sim_wo&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;simulate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;gm0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;nsim&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;re&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;form&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;NA&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nx"&gt;sims&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;sapply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;gm0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;sim_wo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nx"&gt;ones&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;colSums&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sims&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nx"&gt;zeros&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;colSums&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sims&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nx"&gt;perc&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;ones&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;nrow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nx"&gt;cvar&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sims&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;var&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="err"&gt;##&lt;/span&gt; &lt;span class="kd"&gt;with&lt;/span&gt; &lt;span class="nx"&gt;RE&lt;/span&gt;
&lt;span class="nx"&gt;gm0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;sim&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;simulate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;gm0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nx"&gt;sims&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;sapply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;gm0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;sim&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nx"&gt;re_ones&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;colSums&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sims&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nx"&gt;re_zeros&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;colSums&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sims&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nx"&gt;re_perc&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;re_ones&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;nrow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nx"&gt;re_cvar&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sims&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;var&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nx"&gt;pp_comp&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dist&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;cmp_fn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nx"&gt;hist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dist&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;orange&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;xlab&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;value&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...)&lt;/span&gt;
  &lt;span class="nx"&gt;abline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;cmp_fn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nx"&gt;lwd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blue&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;lty&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="nx"&gt;abline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dist&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nx"&gt;lwd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nx"&gt;op&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nx"&gt;par&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;mfrow&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="nx"&gt;pp_comp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="nx"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x$cop&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
          &lt;span class="nx"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;main&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ones - no RE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;xlim&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;45&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;110&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="nx"&gt;pp_comp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x$cop&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
          &lt;span class="nx"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;main&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;zeros -no RE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;xlim&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;120&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;185&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="nx"&gt;pp_comp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;perc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="nx"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x$cop&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;nrow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
          &lt;span class="nx"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;main&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;% cop - no RE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;xlim&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="nx"&gt;pp_comp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cvar&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x$cop&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
          &lt;span class="nx"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;main&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;var - no RE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nx"&gt;pp_comp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;re_ones&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="nx"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x$cop&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
          &lt;span class="nx"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;main&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ones - all RE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;xlim&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;45&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;110&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="nx"&gt;pp_comp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;re_zeros&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x$cop&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
          &lt;span class="nx"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;main&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;zeros - all RE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;xlim&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;120&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;185&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="nx"&gt;pp_comp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;re_perc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="nx"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x$cop&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;nrow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
          &lt;span class="nx"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;main&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;% cop - RE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;xlim&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="nx"&gt;pp_comp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;re_cvar&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x$cop&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
          &lt;span class="nx"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;main&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;var - all RE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="http://www.ashander.info/posts/2015/04/D-RUG-mixed-effects-viz/mixedeffects_viz_files/figure-markdown_strict/post-pred-1.svg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;par(op)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;In this case I've plotted the simulated distributions of the number of
ones, zeros, the proportion of copulations, and the variance in observed
copulations -- all with and without accounting for all the random
effects. For each of these, I show the distribution of the statistic,
its mean (black line), and the mean of the same statistic in the
observed data.&lt;/p&gt;
&lt;p&gt;All test quantities have broader distributions when we account for the
random effects.&lt;/p&gt;
&lt;h2&gt;&lt;code&gt;glmmADMB&lt;/code&gt; version (not run)&lt;/h2&gt;
&lt;p&gt;You can run many of the same graphical procedures (including the quick
plots from &lt;code&gt;lsmeans&lt;/code&gt;!) on output from other frequentist fitting
packages. Try it!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;## look at glmmadmb too -- not evaluated&lt;/span&gt;
gm1admb &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; glmmadmb&lt;span class="p"&gt;(&lt;/span&gt;cop &lt;span class="o"&gt;~&lt;/span&gt; geodist_scl &lt;span class="o"&gt;+&lt;/span&gt;  sizediff_scl2&lt;span class="p"&gt;,&lt;/span&gt; random&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; Series &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; Female &lt;span class="p"&gt;,&lt;/span&gt; data&lt;span class="o"&gt;=&lt;/span&gt;d2&lt;span class="p"&gt;,&lt;/span&gt; family&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;binomial&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

d2 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;data.frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;d2&lt;span class="p"&gt;,&lt;/span&gt; predict&lt;span class="p"&gt;(&lt;/span&gt;gm1admb&lt;span class="p"&gt;,&lt;/span&gt; interval&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;confidence&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; type&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;link&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

plot&lt;span class="p"&gt;(&lt;/span&gt;cop &lt;span class="o"&gt;~&lt;/span&gt; SizeDiff&lt;span class="p"&gt;,&lt;/span&gt; d2&lt;span class="p"&gt;,&lt;/span&gt; ylim &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
lines&lt;span class="p"&gt;(&lt;/span&gt;plogis&lt;span class="p"&gt;(&lt;/span&gt;fit&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; SizeDiff&lt;span class="p"&gt;,&lt;/span&gt; d2&lt;span class="p"&gt;,&lt;/span&gt; lwd&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
lines&lt;span class="p"&gt;(&lt;/span&gt;plogis&lt;span class="p"&gt;(&lt;/span&gt;lwr&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; SizeDiff&lt;span class="p"&gt;,&lt;/span&gt; d2&lt;span class="p"&gt;,&lt;/span&gt; lty&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; lwd&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
lines&lt;span class="p"&gt;(&lt;/span&gt;plogis&lt;span class="p"&gt;(&lt;/span&gt;upr&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; SizeDiff&lt;span class="p"&gt;,&lt;/span&gt; d2&lt;span class="p"&gt;,&lt;/span&gt; lty&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; lwd&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      geom_line&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;SizeDiff&lt;span class="p"&gt;,&lt;/span&gt; plogis&lt;span class="p"&gt;(&lt;/span&gt;lwr&lt;span class="p"&gt;)),&lt;/span&gt; color&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;orange&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; size&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; linetype&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
    geom_line&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;SizeDiff&lt;span class="p"&gt;,&lt;/span&gt; plogis&lt;span class="p"&gt;(&lt;/span&gt;upr&lt;span class="p"&gt;)),&lt;/span&gt; color&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;orange&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; size&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; linetype&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;[1] &lt;em&gt;I haven't read this simulation study carefully yet&lt;/em&gt; but a quick
look implies the main problems occurred when fitting a model that gets
the hierarchy wrong (e.g., a GLM to data generated from a hierarchical
process under-performs relative to a transform + LMM)&lt;/p&gt;
&lt;p&gt;[2] Stroup also authored the CRC Press book &lt;em&gt;Generalized Linear Mixed
Models&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;[3] Discussions with and classes from colleagues, including Scott
Burgess, Andrew Latimer, Richard McElreath, and Will Wetzel, have also
greatly improved my understanding of plotting and fitting mixed models.&lt;/p&gt;</summary><category term="visualization"></category><category term="lattice"></category><category term="model checking"></category><category term="statistical graphics"></category><category term="GLMM"></category><category term="R"></category><category term="ggplot2"></category></entry><entry><title>Between-generation bet-hedging</title><link href="http://www.ashander.info/posts/2015/01/between-generation-bet-hedging/" rel="alternate"></link><updated>2015-01-12T00:00:00-08:00</updated><author><name>Jaime</name></author><id>tag:www.ashander.info,2015-01-12:posts/2015/01/between-generation-bet-hedging/</id><summary type="html">&lt;p&gt;Version of notes for discussion I led in
&lt;a href="http://www.eve.ucdavis.edu/sschreiber/"&gt;Sebastain Schreiber's&lt;/a&gt; for
PBG 271 Research Conference in Ecology on "Life history evolution in
stochastic environments".&lt;/p&gt;
&lt;h3&gt;Reading Childs et al and Stearn's piece on Bernoulli&lt;/h3&gt;
&lt;p&gt;&lt;a href="doi:10.1098/rspb.2010.0707"&gt;Childs, Metcalf and Rees (2010)&lt;/a&gt; present
a plant-focused review of bet-hedging, including a review of essential
theory.  As in many papers on bet-hedging, these authors distiguish
between conservative and diversified strategies.&lt;/p&gt;
&lt;h4&gt;Geometic mean fitness concept&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;When fitness is temporally variable, the appropriate measure of
evolutionary success is the expected geometric mean growth rate of a
genotype. This is because fitness, like population growth, is an
inherently multiplicative process that is very sensitive to
occasional low values. -- Childs et al 2011&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Let's remind ourselves why.&lt;/p&gt;
&lt;p&gt;Following roughly the notation of Frank and Slatkin (1990), let &lt;span class="math"&gt;\(x_i\)&lt;/span&gt; the frequency of genotype &lt;span class="math"&gt;\(i\)&lt;/span&gt; and &lt;span class="math"&gt;\(R_i(t)\)&lt;/span&gt; the mean fitness of genotype &lt;span class="math"&gt;\(i\)&lt;/span&gt; in year &lt;span class="math"&gt;\(t\)&lt;/span&gt;, then
genotype frequency &lt;span class="math"&gt;\(i\)&lt;/span&gt; changes as
&lt;/p&gt;
&lt;div class="math"&gt;$$
x_i(t+1) = \frac{R_i(t)x_i(t)}{R_1(t)x_1(t) + R_2(t)x_2(t)}
$$&lt;/div&gt;
&lt;p&gt;
Setting &lt;span class="math"&gt;\(y(t) = x_1(t)/x_2(t)\)&lt;/span&gt;, we get
&lt;/p&gt;
&lt;div class="math"&gt;$$
y(t+1)=[R_1(t)/R_2(t)]y(t)
$$&lt;/div&gt;
&lt;p&gt;
Hence, &lt;span class="math"&gt;\(y(t) = y(0) \prod_{i=0}^{t-1} \lambda(i)\)&lt;/span&gt; where &lt;span class="math"&gt;\(\lambda(t) =
R_1(t)/R_2(t)\)&lt;/span&gt; is a (non-standard) relative fitness measure.&lt;/p&gt;
&lt;p&gt;We can rearrange this and take logs to see &lt;span class="math"&gt;\(\tfrac{1}{t} \log
(y(t)/y(0)) = \tfrac{1}{t} \sum_{i=0}^{t-1} \log \lambda(i)\)&lt;/span&gt;. Applying
the law of large numbers, &lt;span class="math"&gt;\(E[\log \lambda(t)]\)&lt;/span&gt; determines whether
genotype 1 "wins" (i.e. expectation is &amp;gt;0) or "loses"
(i.e. expectation is &amp;lt;0).But this (&lt;span class="math"&gt;\((\prod_t
\lambda(i))^{\tfrac{1}{t}}\)&lt;/span&gt;) is the geometric mean fitness!&lt;/p&gt;
&lt;!-- If so, please remind folks about the approximation of $E[\log R_1(t)]$
when $R_1(t)=1+s_i(t)$ where $s_i(t)$ has mean zero and is "small". --&gt;

&lt;h4&gt;So the stochastic growth rate &lt;em&gt;is&lt;/em&gt; the geometric mean fitness&lt;/h4&gt;
&lt;p&gt;And these are the appropriate measure of success for long-term evolution in a varying environment.
Stochastic growth rate &lt;span class="math"&gt;\(\rho\)&lt;/span&gt; (in Childs' notation) with &lt;span class="math"&gt;\(\lambda(i)\)&lt;/span&gt; fitness in generation &lt;span class="math"&gt;\(i\)&lt;/span&gt; is&lt;/p&gt;
&lt;div class="math"&gt;$$
\rho = E [ \log (\lambda(i)) ]
$$&lt;/div&gt;
&lt;p&gt;Which we just saw above is the geometic mean fitness.&lt;/p&gt;
&lt;h4&gt;So how does this lead to a mean-variance tradeoff?&lt;/h4&gt;
&lt;!-- The geometric mean fitness over $t$ generations
is $(\prod_n \lambda(t))^{\tfrac{1}{t}}$.  Taking the logarithm of
this, $\tfrac{1}{t} \sum_t \log(\lambda(i))$, which is $\rho$ above. --&gt;

&lt;p&gt;As Childs et al note, Jensen's inequality here implies the geometic
mean fitness is less than the arithmetic mean &lt;span class="math"&gt;\(\rho \le \log
E[\lambda(i)]\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;More specifically, as Sebastian mentioned last week, we can take a
Taylor approximation,&lt;/p&gt;
&lt;div class="math"&gt;$$
E[f(x)] \approx f( E[x]) + \tfrac{1}{2}
f''(E[x]) {\rm Var}(x).
$$&lt;/div&gt;
&lt;p&gt;With &lt;span class="math"&gt;\(f = \log\)&lt;/span&gt; this gives&lt;/p&gt;
&lt;div class="math"&gt;$$
E[\log (\lambda)] \approx \log (E[\lambda]) - \tfrac{1}{2
E[\lambda]^2} {\rm Var}(\lambda),
$$&lt;/div&gt;
&lt;p&gt;implying the magnitude of the decrease from arithmetic to geometic
mean fitness is proportional to the squared coefficient of variation
in fitness.  In fact, if &lt;span class="math"&gt;\(\lambda(i) \approx 1 + \epsilon_i\)&lt;/span&gt; with
&lt;span class="math"&gt;\(\epsilon\)&lt;/span&gt; a "small" random variable with mean zero this gives the
common approximation to the stochastic growth rate &lt;span class="math"&gt;\(\lambda_S \approx
\bar \lambda - \tfrac{1}{2} \sigma_\lambda^2\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;This leads to Slatkin's (1974) coining of &lt;em&gt;evolutionary bet-hedging&lt;/em&gt;
to denote the resulting "tradeoff" where strategies with lower
arithmetic mean fitness can invade against those with higher
arithmetic mean fitness (if they have lower variance).&lt;/p&gt;
&lt;h3&gt;Discussion points&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;is "tradeoff" a good term here? doesn't evolution just favor the maximizer of geometric mean fitness?&lt;/li&gt;
&lt;li&gt;evidence for bet hedging in nature. what is needed and what has been shown?&lt;/li&gt;
&lt;li&gt;BH in structured populations -- IPMs are suggested as means for analyzing, what are obstacles to getting there (e.g. data limitation)?&lt;/li&gt;
&lt;li&gt;conservative versus diversified BH: how to connect this terminology to
  our framework? Any concise model of "conservative" BH?&lt;/li&gt;
&lt;li&gt;whose fitness is it?&lt;/li&gt;
&lt;/ul&gt;
&lt;!--

wzxhzdk:0


\begin{equation}
\exp{x}
\end{equation}
--&gt;

&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }
    
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</summary><category term="life history"></category><category term="evolution"></category><category term="stochasticity"></category></entry><entry><title>Response of fish biota to dams in the Lower Colorado River Basin: empirical findings and utility for predicting responses to climate and water use change</title><link href="http://www.ashander.info/posts/2014/05/response-fish-biota-lower-colorado-river/" rel="alternate"></link><updated>2014-05-26T00:00:00-07:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2014-05-26:posts/2014/05/response-fish-biota-lower-colorado-river/</id><summary type="html">&lt;p&gt;&lt;em&gt;The biologists have done their jobs. We know the life cycles and habitat requirements of endangered western fishes. . . [A] successful management program could be devised and implemented for the Grand Canyon region. Current politics stand in the way, just as surely as politics of the 1960s aided and abetted our efforts to learn enough to save this fauna.&lt;/em&gt; -- W. L. Minckley (1991)&lt;/p&gt;
&lt;p&gt;Over the past century, development of the Colorado River Basin for water
resources changed a dynamic river into a managed system. Seasonality in flow,
temperature, and turbidity is reduced, and formerly riverine habitats are now
reservoirs. These changes have played out in the fish fauna. Native species
have declined and non-natives have increased. The key alteration, relative to
the past, is increased competition and predation, especially at juvenile
stages, which is likely mediated by more stable flow and resource regimes.
A dataset (SONFISHES) assembled by W. L. Minckley and covering 150 years of
fish occurrence in the Lower Colorado River (below Glen Canyon Dam) has
provided insight into patterns in extirpation among native fishes and range
expansion among non-native fishes. Several studies have combined these data
with measures of extinction risk to explain how range fragmentation and
species’ traits correlate with observed extinctions or threats in native
species. Another study analyzed range shifts within a strategy space of
potential fish life histories (originally introduced by K. O. Winemiller and K.
A. Rose) to understand how human activity has created and removed ecological
niches. Together, these studies support a causal link between environmental and
faunal change. This strongly suggests that continuing the status quo will
result in further extirpation and extinction of native fishes. I argue,
however, that current knowledge is not yet sufficient to quantitatively
forecast the magnitude and timescale of the response in fish biodiversity to
any projected future environment. Such forecasting requires a model that
quantitatively relates the environment to persistence in the strategy-space of
fish life histories. Unfortunately, we do not need such a model to make the
qualitative prediction: threatened "big-river" fishes will eventually go
extinct without intervention.&lt;/p&gt;</summary><category term="Colorado River"></category><category term="life history theory"></category><category term="conservation biology"></category><category term="invasive species"></category><category term="population biology"></category><category term="Floodplain"></category></entry><entry><title>Understanding the joint effects of plastic and evolutionary change on demography from time series</title><link href="http://www.ashander.info/posts/2014/01/understanding-joint-effects-plastic-evolutionary-poster/" rel="alternate"></link><updated>2014-01-03T21:19:00-08:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2014-01-03:posts/2014/01/understanding-joint-effects-plastic-evolutionary-poster/</id><summary type="html">&lt;p&gt;Background/Question/Methods&lt;/p&gt;

&lt;p&gt;In nature, selection often fluctuates, but observed changes in traits may owe not only to selection but plasticity. Further, changes in traits due to selection and to plasticity do not have equal demographic effects: the cost of selection is paid through declines in population number or growth rate. Thus, observed trajectories of trait value and population number can depend on interactions between plasticity, evolution and environment. The extent to which these interactions affect observed trajectories depends on the demographic context. For example, it has long been known that natural selection interacts with density-dependence, which can dilute the effect of selection on population dynamics. Although recent methods decompose observed trait change into contributions due to evolution and plasticity, these methods have not yet fully accounted for the effect of selection on demography. In particular, including information about demographic change may sharpen inference of selection versus plasticity from time series.&lt;/p&gt;

&lt;p&gt;Results/Conclusions&lt;/p&gt;

&lt;p&gt;I develop a framework to account for the joint effects of plastic and evolutionary change on population and trait dynamics. This framework focuses on the influence of selection by a seasonal environment on timing of life history events, accommodating mechanistic hypotheses concerning the form of selection. I demonstrate how the framework can be used to infer the action of plasticity and genetic evolution from time series in a case study of changes in migration timing of Pacific salmon (Oncorhynchus nerka).&amp;nbsp;&lt;/p&gt;</summary><category term="phenotypic plasticity"></category><category term="ESA2013"></category><category term="time series"></category><category term="Bayesian methods"></category><category term="phenology"></category></entry><entry><title>Allee effect from parasite spill-back</title><link href="http://www.ashander.info/posts/2013/09/allee-effect-spillback/" rel="alternate"></link><updated>2013-09-05T00:00:00-07:00</updated><author><name>Martin Krkosek</name></author><id>tag:www.ashander.info,2013-09-05:posts/2013/09/allee-effect-spillback/</id><summary type="html">&lt;p&gt;The exchange of native pathogens between wild and domesticated animals
can lead to novel disease threats to wildlife. However, the dynamics
of wild host-parasite systems exposed to a reservoir of domesticated
hosts are not well understood. A simple mathematical model reveals
that the spill-back of native parasites from domestic to wild hosts
may cause a demographic Allee effect in the wild host population. A
second model is tailored to the particulars of pink salmon
(Oncorhynchus gorbuscha) and salmon lice (Lepeophtheirus salmonis),
for which parasite spill-back is a conservation and fishery
concern. In both models, parasite spill-back weakens the coupling of
parasite and wild host abundance-particularly at low host
abundance-causing parasites per host to increase as a wild host
population declines. These findings show that parasites shared across
host populations have effects analogous to those of generalist
predators and can similarly cause an unstable equilibrium in a focal
host population that separates persistence and extirpation. Allee
effects in wildlife arising from parasite spill-back are likely to be
most pronounced in systems where the magnitude of transmission from
domestic to wild host populations is high because of high parasite
abundance in domestic hosts, prolonged sympatry of domestic and wild
hosts, a high transmission coefficient for parasites, long-lived
parasite larvae, and proximity of domesticated populations to wildlife
migration corridors.&lt;/p&gt;</summary><category term="peer reviewed"></category><category term="M.Sc."></category><category term="Allee effect"></category><category term="spillback"></category><category term="spillover"></category><category term="salmon"></category><category term="aquaculture"></category></entry><entry><title>Modifying River-Floodplain Systems: A Historical and Ecological Perspective</title><link href="http://www.ashander.info/posts/2012/10/igert-workshop-pres/" rel="alternate"></link><updated>2012-10-01T00:00:00-07:00</updated><author><name>Ross, Noam</name></author><id>tag:www.ashander.info,2012-10-01:posts/2012/10/igert-workshop-pres/</id><summary type="html">&lt;p&gt;This presentation made 9/14 at the UC Davis REACH IGERT Floodplains workshop, by Jaime Ashander, Kelly Gravuer, Megan Kelso, Mary E. Mendoza, Noam Ross&lt;/p&gt;</summary><category term="Floodplain"></category><category term="Modifying"></category><category term="Population Biology"></category></entry><entry><title>Trade-Offs and Synergies in Floodplain Management - A Historical-Ecological Approach</title><link href="http://www.ashander.info/posts/2012/05/trade-offs-synergies-floodplain-management-historical-ecological/" rel="alternate"></link><updated>2012-05-11T03:45:00-07:00</updated><author><name>Kelly Gravuer</name></author><id>tag:www.ashander.info,2012-05-11:posts/2012/05/trade-offs-synergies-floodplain-management-historical-ecological/</id><summary type="html">&lt;p&gt;This video and poster introduces our project, "Trade-Offs and Synergies in Floodplain Management - A Historical-Ecological Approach"&lt;/p&gt;
&lt;p&gt;Floodplains have long been favored sites for agriculture and settlement due to their fertility, flat topography, and proximity to rivers for easy transport of goods. To reduce flood risk attendant with flood plain settlement, extensive flood protection structures have been built, including elaborate networks of levees. These modifications have greatly reduced the ecological benefits that intact river-flood plain systems provide. There is increasing recognition that flood plain reconnection can restore some ecological benefits while further reducing flood risk. However, few of these promising multi-purpose projects have been implemented because we lack both practical methodologies for estimating benefits and an understanding of historical conditions likely to facilitate project success.&lt;/p&gt;
&lt;p&gt;Here, we use both historical and biophysical approaches to examine the trade-offs and synergies among the benefits of a proposed flood plain reconnection project in California. We examine the social evolution of attitudes and views that shaped floodplain management decisions, and that led to moments of conflict and cooperation among actors with varied interests. We also use hydraulic and population modeling to predict the effect of flood plain reconnection on key ecological benefits, flood risk, and availability of land for agriculture. In combination, these approaches provide a novel view on how social and biological forces constrain and provide opportunities in floodplain management. This understanding could support effective implementation of multi-purpose projects.&lt;/p&gt;
&lt;p&gt;&lt;a href="dox.doi.org/10.6084/m9.figshare.92041"&gt;Video also available at DOI 10.6084/m9.figshare.92041&lt;/a&gt;.&lt;/p&gt;</summary><category term="Trade Offs"></category><category term="Synergies"></category><category term="Floodplain"></category><category term="Management"></category><category term="Historical"></category><category term="Ecological"></category></entry><entry><title>The Central Valley long ago</title><link href="http://www.ashander.info/posts/2011/07/Unhealth-plain/" rel="alternate"></link><updated>2011-07-25T00:00:00-07:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2011-07-25:posts/2011/07/Unhealth-plain/</id><summary type="html">&lt;blockquote&gt;
&lt;p&gt;The plain is unhealthy and infested with mosquitos in incredible
numbers and of unparalleled ferocity --- William Brewer, 1861&lt;/p&gt;
&lt;/blockquote&gt;</summary><category term="musing"></category><category term="California history"></category></entry><entry><title>Rapid evolution, local adaption, and model-data connections</title><link href="http://www.ashander.info/posts/2011/06/phd-initial-summary/" rel="alternate"></link><updated>2011-06-29T00:00:00-07:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2011-06-29:posts/2011/06/phd-initial-summary/</id><summary type="html">&lt;p&gt;My Ph.D. is focused on modelling populations that exhibit rapid responses to enviornmental change.
Potential applications include salmon, annual plants, and infectious disease.
I'm particularly interested in transient dynamics, connecting models to data, and forecasting.&lt;/p&gt;</summary><category term="Ph.D."></category><category term="local adaptation"></category><category term="evolution"></category><category term="stochasticity"></category><category term="transient dynamics"></category><category term="population biology"></category></entry><entry><title>Aquaculture-induced changes to dynamics of a migratory host and specialist parasite: a case study of pink salmon and sea lice</title><link href="http://www.ashander.info/posts/2011/03/line-dominance-sea-lice/" rel="alternate"></link><updated>2011-03-17T00:00:00-07:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2011-03-17:posts/2011/03/line-dominance-sea-lice/</id><summary type="html">&lt;p&gt;Exchange of diseases between domesticated and wild animals is a rising
concern for conservation. In the ocean, many species display life
histories that separate juveniles from adults. For pink salmon
(Oncorhynchus gorbuscha) and parasitic sea lice (Lepeophtheirus
salmonis), infection of juvenile salmon in early marine life occurs
near salmon sea-cage aquaculture sites and is associated with
declining abundance of wild salmon. Here, we develop a theoretical
model for the pink salmon/sea lice host–parasite system and use it to
explore the effects of aquaculture hosts, acting as reservoirs, on
dynamics. Because pink salmon have a 2-year lifespan, even- and
odd-year lineages breed in alternate years in a given river. These
lineages can have consistently different relative abundances, a
phenomenon termed “line dominance”. These dominance relationships
between host lineages serve as a useful probe for the dynamical
effects of introducing aquaculture hosts into this host–parasite
system. We demonstrate how parasite spillover (farm-to-wild transfer)
and spillback (wild-to-farm transfer) with aquaculture hosts can
either increase or decrease the line dominance in an affected wild
population. The direction of the effect depends on the response of
farms to wild-origin infection. If aquaculture parasites are managed
to a constant abundance, independent of the intensity of infections
from wild to farm, then line dominance increases. On the other hand,
if wild-origin parasites on aquaculture hosts are proportionally
controlled to their abundance then line dominance decreases.&lt;/p&gt;</summary><category term="peer reviewed"></category><category term="M.Sc."></category><category term="line dominance"></category><category term="pink salmon"></category><category term="spillback"></category><category term="spillover"></category><category term="aquaculture"></category></entry><entry><title>Population biology in regulated rivers: application to regulation and restoration</title><link href="http://www.ashander.info/posts/2010/09/population-biology-in-regulated-rivers/" rel="alternate"></link><updated>2010-09-29T00:00:00-07:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2010-09-29:posts/2010/09/population-biology-in-regulated-rivers/</id><summary type="html">&lt;p&gt;Several projects apply concepts and methods from population biology to applied issues in river management and conservation:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;IGERT collaborative project on &lt;a href="http://reach.ucdavis.edu/programs/floodplains.html"&gt;Floodplain management: opportunities, challenges, and successes&lt;/a&gt; with collaborators Kelly Graveur, Megan Kelso, Mary Mendoza, and &lt;a href="http://www.noamross.net/"&gt;Noam Ross&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Colorado River Class and Grand Canyon trip: "The Changing Colorado River". Check out &lt;a href="https://watershed.ucdavis.edu/education/classes/ecogeomorphology-grand-canyon-2014/photos/lower-canyon-part-1"&gt;some&lt;/a&gt; &lt;a href="https://watershed.ucdavis.edu/education/classes/ecogeomorphology-grand-canyon-2014/photos/lower-canyon-part-2"&gt;photos&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</summary><category term="floodplains"></category><category term="salmon"></category><category term="restoration"></category><category term="applied ecology"></category><category term="population biology"></category><category term="Grand Canyon"></category><category term="optimization"></category><category term="economics"></category></entry><entry><title>Effects of parasite exchange among farm and wild salmon</title><link href="http://www.ashander.info/posts/2010/08/parasite-exchange/" rel="alternate"></link><updated>2010-08-29T00:00:00-07:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2010-08-29:posts/2010/08/parasite-exchange/</id><summary type="html">&lt;p&gt;My master's research focused on the evolutionary ecology of sea lice,
   farmed and wild salmon. I'm particularly interested in the ways in
   which the combination of wild salmon migrations and salmon farm
   management can influence chemical resistance evolution on farms.&lt;/p&gt;
&lt;p&gt;Sea lice tend to proliferate on sea-cage farmed salmon, resulting in
economic costs to the farmers. These outbreaks can also affect wild
populations, which raises concerns about population conservation and
the environmental costs of sea-cage aquaculture. Salmon farmers
address these concerns with integrated pest management (IPM)
strategies that include chemical treatments. These chemicals can
reduce parasite numbers, but over time, parasites can develop a
resistance to the chemicals.&lt;/p&gt;
&lt;p&gt;In coastal B.C. new conservation regimes rely on increased use of
  chemical treatments, which is classically associated with resistance
  emergence. Achieving conservation goals could then actually
  &lt;em&gt;increase&lt;/em&gt; the risk of resistance emergence; however, flow of
  susceptible genes from lice on wild fish into populations on farms
  could delay resistance emergence (similar to "refuge" planting in
  agriculture).&lt;/p&gt;
&lt;h3&gt;Wild salmon demography&lt;/h3&gt;
&lt;p&gt;Sustained exchange of parasites between wild and farmed salmon,
  combined with wild salmon migrations can alter dynamical patterns in
  salmon populations. Notably, patterns of line dominance in pink
  salmon may change in the presence of farms.  Line dominance can
  either increase or decrease, depending on the way in which salmon
  farms respond to infections.&lt;/p&gt;
&lt;p&gt;In a follow-up study, coworkers and I show that sustained spill-back
into wild reservoir hosts can result in an Allee effect in the wild
hosts.&lt;/p&gt;
&lt;h3&gt;Parasite evolution&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;Goal&lt;/em&gt;: Understand feedbacks between increasing chemical use,
 conservation and resistance management in the context of sea lice,
 wild salmon and salmon farms.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Hypothesis&lt;/em&gt;: Wild salmon serve as evolutionary refuges, slowing
resistance evolution in sea lice. &lt;!--, and thus provide an
_ecosystem service_. --&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Questions:&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp; &lt;strong&gt;How do wild salmon migrations near farms affect time to resistance emergence?&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Specifically, how do
  management actions (treatment, stocking density) affect time to
  resistance?&lt;/li&gt;
&lt;li&gt;What are the effects of biological assumptions?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&amp;nbsp; &lt;strong&gt;How does varying synchrony of treatments on groups of farms change things?&lt;/strong&gt;&lt;/p&gt;</summary><category term="sea lice"></category><category term="salmon"></category><category term="resistance evolution"></category><category term="complex population dynamics"></category><category term="population biology"></category><category term="mathematical ecology"></category></entry><entry><title>Effects of Parasite Exchange Between Wild and Farmed Salmon</title><link href="http://www.ashander.info/posts/2010/08/effects-parasite-exchange-wild-farmed-salmon/" rel="alternate"></link><updated>2010-08-20T00:00:00-07:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2010-08-20:posts/2010/08/effects-parasite-exchange-wild-farmed-salmon/</id><summary type="html">&lt;p&gt;Human food production activities can dominate natural systems, altering
ecological and evolutionary aspects of the environment. Disease-mediated
interactions are of particular concern. For example, parasites may "spill-over"
from farms to wildlife. Parasites isolated on farms can evolve resistance to
treatment chemicals , but "spill-back" from wildlife to farms may alter
evolutionary dynamics. Here, we consider exchange of parasites (&lt;em&gt;Lepeophtheirus
salmonis&lt;/em&gt;) between wild (&lt;em&gt;Oncorhynchus gorbuscha&lt;/em&gt;) and farmed salmon. We derive
and analyze discrete-time models that implicitly include wild salmon
migrations. First, we extend a standard fisheries model to show parasite
exchange affects "line-dominance" in the population ecology of salmon. Second,
we extend a classic population genetics model to show that wild salmon can
theoretically provide an "ecosystem service" by delaying the onset of chemical
resistance in parasites on farms. This service, however is affected by
a nonlinear feedback if farm parasites spill-back to affect wild salmon.&lt;/p&gt;</summary><category term="thesis"></category><category term="M.Sc."></category><category term="line dominance"></category><category term="pink salmon"></category><category term="spillback"></category><category term="spillover"></category><category term="aquaculture"></category><category term="drug resistance"></category><category term="chemical resistance"></category><category term="mathematical modelling"></category><category term="migration"></category><category term="population genetics"></category></entry><entry><title>Jobless recovery and growth-signalling autonomy</title><link href="http://www.ashander.info/posts/2010/01/Jobless-recovery/" rel="alternate"></link><updated>2010-01-14T00:00:00-08:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2010-01-14:posts/2010/01/Jobless-recovery/</id><summary type="html">&lt;blockquote&gt;
&lt;p&gt;We help companies to grow by helping them to raise capital...
Companies that grow create wealth. This, in turn, allows
people to have jobs that create more growth and more wealth. It's a
virtuous cycle. We have a social purpose. --- Lloyd Blankfein&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Ed Abbey wrote that Blankfein's virtuous cycle, growth for the sake of
growth, is "the logic of the cancer cell". Whether or not you buy this
anti-captialist mumbo jumbo, there &lt;em&gt;is&lt;/em&gt; something cancerous about a
jobless, finance-led recovery. One of the hallmarks of cancer is &lt;a
href="http://bit.ly/76O6uy"&gt;growth-signaling autonomy&lt;/a&gt;. It would
seem that Blankfein's cycle requires jobs. Thus a jobless "recovery"
indicates that the finance sector has developed autonomy from the
signals of the labor market.&lt;/p&gt;</summary><category term="musing"></category><category term="economy"></category><category term="finance"></category></entry><entry><title>Science education and uncertainty</title><link href="http://www.ashander.info/posts/2009/12/Science-is-uncertain/" rel="alternate"></link><updated>2009-12-04T00:00:00-08:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2009-12-04:posts/2009/12/Science-is-uncertain/</id><summary type="html">&lt;p&gt;A brand new "-gate" on the climate science front has me thinking about
the relationship between science and the public. A big issue in
communicating science stems from the fundamental disconnect between
science as practiced and science as taught in introductory formats,
e.g. in high school.&lt;/p&gt;
&lt;p&gt;Most people learn science as fact. The reality is emerging scientific
knowledge (in fact all scientific knowledge) is uncertain. Those who
disagree idealogically with the state of scientific knowlege highlight
this uncertainty. Because the public doesn't understand what science
&lt;em&gt;really&lt;/em&gt; is, the effect is to sew seeds of doubt.&lt;/p&gt;
&lt;p&gt;A more productive focus would be to discuss quantitative measures of
uncertainty and degrees of risk tolerance. The notion that certainty
is possible, however, short circuits this discussion.&lt;/p&gt;</summary><category term="musing"></category><category term="science"></category><category term="public"></category><category term="climate"></category></entry><entry><title>Wrong, not confused</title><link href="http://www.ashander.info/posts/2009/11/Wrong-not-confused/" rel="alternate"></link><updated>2009-11-10T00:00:00-08:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2009-11-10:posts/2009/11/Wrong-not-confused/</id><summary type="html">&lt;p&gt;Quoting Turchin (1998) quoting Hull (1988) quoting Bacon (?) : &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;In science it is better to be wrong than confused.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The point is, though a mathematical model that purports to repesent
reality will be wrong, one with clear definitions and assumptions can
be helpful. Mathematical modeling is a tool to move from confusion
about a process to making clear (if wrong) statements about that
process.&lt;/p&gt;</summary><category term="musing"></category><category term="science"></category><category term="models"></category><category term="philosophy"></category></entry><entry><title>Negative results or technical problems?</title><link href="http://www.ashander.info/posts/2009/11/Omitting-negative-results/" rel="alternate"></link><updated>2009-11-02T00:00:00-08:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2009-11-02:posts/2009/11/Omitting-negative-results/</id><summary type="html">&lt;p&gt;True or false: "Non-publication of negative results is extraordinarily common in science...." ?&lt;/p&gt;
&lt;p&gt;This comes from biomed world, specifically protein design, where some
awesome claims---design of protein receptors to detect TNT (the
explosive) among other things---have &lt;a href="http://www.nature.com/news/2009/091012/full/news.2009.998.html"&gt;come under
scrutiny&lt;/a&gt;.
The lab involved &lt;a href="http://www.nature.com/news/2008/080509/full/453275a.html"&gt;recently retracted some other
work&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The quotation above is from Loren Looger, who was a PhD student on the
project. He's referrring to unreported instances where a designed
protein didn't bind the target and concludes that the omission "did
not seem inappropriate." This brings up an important distinction, I
think, between negative results and experimental or procedural
problems.&lt;/p&gt;
&lt;p&gt;I'm not an experimentalist, but I'll draw an analogy with
&lt;em&gt;coding&lt;/em&gt;. Let's say you're coding up a simulation for a random walk on
a one-dimensional lattice with the goal of estimating the waiting time
to reach a certain node, #N#. Let's say you don't realize there's an
exact calculation for this, but you do have some idea about the
distribution that the simulation should produce. You use that expected
distribution in debugging and error checking. Your first version
produces answers that don't fit your distributional expectations, you
find some errors and you fix them . The next version seems right. Then
you do 10,000 simulations of 2000 steps each to find the waiting time
to reach &lt;em&gt;N&lt;/em&gt; (let's say N &amp;lt;&amp;lt; 2000). You report the waiting time as the
average of the 10,000 runs, discarding the results of the first
version.&lt;/p&gt;
&lt;p&gt;In this case it seems perfectly reasonable to not discuss the errors
in getting the code right in reporting the results. The erroneous code
and the results it produced represent technical issues encountered on
the way to real, reportable results.&lt;/p&gt;
&lt;p&gt;Let's say however, you were interested in the probability that of ever
reaching &lt;em&gt;N&lt;/em&gt;. You should similarly report that probability as the
proportion of the 10,000 runs that &lt;em&gt;ever&lt;/em&gt; reached &lt;em&gt;N&lt;/em&gt;. If you
discarded the results that never reached &lt;em&gt;N&lt;/em&gt; you would say the
probability is 1. In this case you would be omitting &lt;em&gt;real&lt;/em&gt; (but
negative) &lt;em&gt;results&lt;/em&gt; and mis-reporting your findings.&lt;/p&gt;
&lt;p&gt;I wonder, to which type of "negative results" is Looger referring?&lt;/p&gt;</summary><category term="musing"></category><category term="science"></category><category term="inference"></category><category term="ethics"></category></entry><entry><title>Salish Sea</title><link href="http://www.ashander.info/posts/2009/10/Salish-sea/" rel="alternate"></link><updated>2009-10-31T00:00:00-07:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2009-10-31:posts/2009/10/Salish-sea/</id><summary type="html">&lt;p&gt;&lt;img alt="Salish Sea from WWU" src="http://www.ashander.info/images/Freelan_SalishSea_small.jpeg" /&gt;&lt;/p&gt;
&lt;p&gt;"Salish Sea" is on its way to being an official name in the U.S. and
Canada. Can &lt;a
href="http://en.wikipedia.org/wiki/Cascadia_(independence_movement)"&gt;
Cascadia&lt;/a&gt; be far behind?&lt;/p&gt;
&lt;p&gt;Stefan Freelan at WWU made the beautiful map of the region here. &lt;a href="http://staff.wwu.edu/stefan/salish_sea.shtml"&gt;His
page&lt;/a&gt; has lots
of details about the region and the history of the term.&lt;/p&gt;</summary><category term="musing"></category><category term="PNW"></category><category term="geography"></category><category term="Cascadia"></category></entry><entry><title>Whisker as integral</title><link href="http://www.ashander.info/posts/2009/10/Whisker-integral/" rel="alternate"></link><updated>2009-10-25T00:00:00-07:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2009-10-25:posts/2009/10/Whisker-integral/</id><summary type="html">&lt;p&gt;An NYT column reports on &lt;a
href="http://www.nytimes.com/2009/10/20/science/20obseal.html"&gt;fur
seal whiskers&lt;/a&gt; serving as biogeochemical records. This kind of data
is more and more common, e.g. otoliths, feathers, shells. What can
scientists do with it?&lt;/p&gt;
&lt;p&gt;I've mainly seen biogeochemical markers used to infer relatively
static traits of individual like origin and age or to make
coarse-scale statements about diet (trophic level). The fur seal study
got trophic information at a bit finer scale (within-year variation),
connecting that to yearly migrations. This is great, but I think
really exciting work lies a little further along this path.&lt;/p&gt;
&lt;p&gt;Essentially these markers can integrate several years of life for an
individual---recording diet and sometimes other environmental
features---in some cases they record the entire lifespan. The
combination of these integrating markers with tagging data
(effectively 'differential' markers) is especially exciting. It would
be cool to see cases where hypotheses (models) developed using one
type of data were selected using the other type.&lt;/p&gt;</summary><category term="musing"></category><category term="animal movement"></category><category term="biogeochemical data"></category></entry><entry><title>Par avion</title><link href="http://www.ashander.info/posts/2009/10/Voting-from-Canada/" rel="alternate"></link><updated>2009-10-23T00:00:00-07:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2009-10-23:posts/2009/10/Voting-from-Canada/</id><summary type="html">&lt;p&gt;Today I mailed my absentee ballot for the S.F. municipal election. The
Good People footed the bill to send it up here to me in Edmonton, I'm
not sure whether they intended to spring for the return journey.&lt;/p&gt;
&lt;p&gt;The only clue was the cryptic (to me) "U.S. Postage Paid. 39 USC
3406. PAR AVION" printed in the upper right hand corner of the return
envelope.  I'm not sure why it would say 'par avion' if they weren't
intending to pay, but if they were why would it say 'U.S' postage?
Confusing.&lt;/p&gt;
&lt;p&gt;In any case the Post Canada folks weren't confused and knew I had to
pay $2.&lt;/p&gt;</summary><category term="musing"></category><category term="Canada"></category><category term="voting abroad"></category></entry><entry><title>Market substitution in aquaculture</title><link href="http://www.ashander.info/posts/2009/10/Market-substitution-aquaculture/" rel="alternate"></link><updated>2009-10-15T00:00:00-07:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2009-10-15:posts/2009/10/Market-substitution-aquaculture/</id><summary type="html">&lt;p&gt;A recent article in &lt;a
href="http://sitemaker.umich.edu/diana.lab/files/diana_2009_bioscience.pdf"&gt;BioScience&lt;/a&gt;
[1] focused on the relationship between aquaculture and
conservation. This topic is quite interesting to me, but it's
obviously subtle. I don't have well-defined thoughts except that (i)
aquaculture could theoretically relieve pressure on some wild
fisheries and (ii) certain aquaculture operations have proven negative
impacts on some ecosystems.&lt;/p&gt;
&lt;p&gt;This paper aims to highlight broad trends in capture and culture
fisheries and quantify effects on biodiversity. I only skimmed it and
can't say how it does overall but one thing jumped out at me.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Image from Diana 2009" src="http://www.ashander.info/images/sub.png" /&gt;&lt;/p&gt;
&lt;p&gt;The author, James Diana [2], describes a trend (shown in the figure
reproduced here [3]) as "market substitution". Now, the wild capture
(black dots) going down and the culture production (white dots) going
up makes for a tidy substitution story. But the figure uses
&lt;em&gt;dual-scaled&lt;/em&gt; axes (which you might &lt;a
href="http://www.perceptualedge.com/articles/visual_business_intelligence/dual-scaled_axes.pdf"&gt;
never want to use &lt;/a&gt;), so the real story might look something like
the second figure (data &lt;em&gt;simulated&lt;/em&gt; in &lt;em&gt;R&lt;/em&gt; by yerstruly):&lt;/p&gt;
&lt;p&gt;&lt;img alt="Simulated data" src="http://www.ashander.info/images/rsim.png" /&gt;&lt;/p&gt;
&lt;p&gt;The second figure makes clear that the changes in wild capture during
1980 to 200x were mere &lt;em&gt;noise&lt;/em&gt; compared to the changes in aquaculture
production. Seems like something more fundamental than simple market
substitution might underly the aquaculture growth, no? In reality, the
white dots represent growth due to the successful commoditization of
what was formely a luxury good--- wild caught salmon---essentially the
creation of a new market. (Aside: this curve is probably similar to
the curve we'd see if we plotted, starting during the late 1800's,
Pacific canned salmon production against East Coast wild capture
Atlantic production... another case where a new market was created
through commoditization.)&lt;/p&gt;
&lt;p&gt;My question: what effect does the underlying market shift have on our
ability to infer market &lt;em&gt;substitution&lt;/em&gt; from production data?&lt;/p&gt;
&lt;p&gt;&lt;refs&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Diana, J.S.  2009.  Aquaculture production and biodiversity conservation.  BioScience. 59:27-38.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Who is well-established, well-educated (he went to UA ;-), and an expert on aquaculture, mostly shrimp-culture in SE asia. He might have a more subtle economic analysis underlying this trend analysis, or this might be Econ 101 and I'm just confused.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;...for the purposes of &lt;a href="http://fairuse.stanford.edu/Copyright_and_Fair_Use_Overview/chapter9/9-a.html"&gt;comment or criticism, i.e. under fair use&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;/refs&gt;&lt;/p&gt;
&lt;!--
xyr = 1980:2005
plot(xyr, exp(seq(log(14),log(4),len=length(xyr))), ylim=c(0,1400),type='o', col='black', pch=19, xlab='year', ylab='million tons')
points(xyr,exp(seq(log(14),log(1200), len=length(xyr))), type='o')
--&gt;</summary><category term="musing"></category><category term="science"></category><category term="inference"></category></entry><entry><title>Canadian lag</title><link href="http://www.ashander.info/posts/2009/09/Canadian-lag/" rel="alternate"></link><updated>2009-09-01T00:00:00-07:00</updated><author><name>Jaime Ashander</name></author><id>tag:www.ashander.info,2009-09-01:posts/2009/09/Canadian-lag/</id><summary type="html">&lt;p&gt;The
 &lt;a href="http://coastalvoices.blogspot.com/2009/08/last-few-days-have-seen-flurry-of.html#comment"&gt;Coastal Voices&lt;/a&gt;
 blog at Living Oceans had an intersting post up remarking on the
 disparity between Canadian's self-image as environmental progressives
 and reality---that they appeaer to lag the U.S. in marine protection
 and other conservation issues. The author wondered &lt;em&gt;why&lt;/em&gt; this might
 be. I left a comment, which I'll expand on here.&lt;/p&gt;
&lt;p&gt;I've had similar thoughts and my guess is this blind spot for domestic
environmental issues owes to Canada's: (i) vast wild-lands (natural
resources), (ii) very low population and (iii) long-standing economic
dependence on extraction of those resources. Canada is simply less far
along in 'using up' its domestic natural resources, and thus less
steeped in the urgency of purpose that comes with realizing human uses
can exhuast nature's bounty.&lt;/p&gt;
&lt;p&gt;From my vague understanding of history, nature's inexhaustability was
unquestioned during early European settlement and the bounty of the
Territories consistently awed settlers during westward expansion. The
gradual 'filling up' of the U.S. and concomitant loss of wilderness
and formerly abundant species eventually fostered a movement to
conserve wild lands for their own sake (or at least for the sake of
hunting).&lt;/p&gt;
&lt;p&gt;I don't think the U.S. 'lead' on these issues owes to anything other
than our other lead---on using up our finite resources. Of course,
despite that other lead, U.S. laws aren't as strong as they might
be---in particular environmental-protection measures typically defer
to entrenched local users---so I guess both U.S. and Canadian
attitudes about conservation could use a bost.&lt;/p&gt;</summary><category term="musing"></category><category term="Canada"></category></entry></feed>